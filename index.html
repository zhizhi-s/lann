<!DOCTYPE html>
<html lang="ku">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>⁄©ÿ™€éÿ®ÿÆÿßŸÜ€ï€å ⁄©€ÜŸÑ€é⁄ò€å ÿ≥⁄µÿßÿ≠€ïÿØ€åŸÜ - ÿ®€ïÿ¥€å ÿ≤ŸÖÿßŸÜ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase Import -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, getDocs, getDoc, query, where, orderBy } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyDldHXuM8uPbgOT-hxRHk5e7YnSkKn0pHI",
            authDomain: "lanuage-slahaddin.firebaseapp.com",
            projectId: "lanuage-slahaddin",
            storageBucket: "lanuage-slahaddin.firebasestorage.app",
            messagingSenderId: "887991955360",
            appId: "1:887991955360:web:e23481e92a29e91578fec5",
            measurementId: "G-GWLZDH54WL"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
        
        // Export Firebase functions to global scope
        window.firebase = {
            db,
            collection,
            addDoc,
            updateDoc,
            deleteDoc,
            doc,
            getDocs,
            getDoc,
            query,
            where,
            orderBy
        };
        
        console.log("Firebase loaded successfully!");
    </script>
    
    <!-- Firebase Import ÿ®ÿ±ÿß€å ÿ≥€åÿ≥ÿ™ŸÖ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ⁄©ÿ™ÿßÿ® -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getFirestore, doc, setDoc, updateDoc, deleteDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

        const firebaseConfig2 = {
            apiKey: "AIzaSyAQFvCjl4gFzWNwo-FrzDH1gcoOL-3J01c",
            authDomain: "zhi-zhi-6bf65.firebaseapp.com",
            projectId: "zhi-zhi-6bf65",
            storageBucket: "zhi-zhi-6bf65.firebasestorage.app",
            messagingSenderId: "132021379654",
            appId: "1:132021379654:web:07e6f4d152a3d8e9436047",
            measurementId: "G-9TVLKJH8BY"
        };

        // Initialize Firebase ÿØŸàŸÖ
        const app2 = initializeApp(firebaseConfig2, "app2");
        const db2 = getFirestore(app2);

        // Export Firebase ÿØŸàŸÖ functions to global scope
        window.firebase2 = {
            db: db2,
            setDoc,
            updateDoc,
            deleteDoc,
            doc,
            getDocs,
            collection
        };
        
        console.log("Firebase ÿØŸàŸÖ ÿ®ÿ±ÿß€å ÿ≥€åÿ≥ÿ™ŸÖ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ⁄©ÿ™ÿßÿ® loaded successfully!");
        
        // ----------------------------
        // ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å ⁄©ÿ™€éÿ® ÿ®€Ü ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ
        async function addRequest(request) {
            try {
                await setDoc(doc(db2, "Language", request.id), request);
                console.log("ÿØÿßŸàÿß⁄©ÿßÿ±€å ÿ≤€åÿßÿØ⁄©ÿ±ÿß ÿ®€Ü ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", request.name);
                return true;
            } catch (error) {
                console.error("Ÿá€ï⁄µ€ï ⁄ïŸàŸàÿØÿß ŸÑ€ï ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ ÿ®€Ü ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", error);
                return false;
            }
        }

        // ----------------------------
        // ŸÇÿ®ŸàŸà⁄µ⁄©ÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å (Ÿæ€ïÿ≥€ïŸÜÿØ) ÿ®€Ü ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ
        async function approveRequest(id) {
            try {
                const entryRef = doc(db2, "Language", id);
                await updateDoc(entryRef, { pasand: true });
                console.log("ÿØÿßŸàÿß⁄©ÿßÿ±€å ŸÇÿ®ŸàŸà⁄µ⁄©ÿ±ÿß ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", id);
                return true;
            } catch (error) {
                console.error("Ÿá€ï⁄µ€ï ⁄ïŸàŸàÿØÿß ŸÑ€ï ŸÇÿ®ŸàŸà⁄µ⁄©ÿ±ÿØŸÜ ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", error);
                return false;
            }
        }

        // ----------------------------
        // ÿ≥⁄ï€åŸÜ€ïŸà€ï€å ÿØÿßŸàÿß⁄©ÿßÿ±€å ÿ®€Ü ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ
        async function rejectRequest(id) {
            try {
                await deleteDoc(doc(db2, "Language", id));
                console.log("ÿØÿßŸàÿß⁄©ÿßÿ±€å ÿ®€åÿ≥⁄ïÿØÿ±ÿß€å€ïŸà€ï ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", id);
                return true;
            } catch (error) {
                console.error("Ÿá€ï⁄µ€ï ⁄ïŸàŸàÿØÿß ŸÑ€ï ÿ≥⁄ï€åŸÜ€ïŸà€ï ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", error);
                return false;
            }
        }
        
        // ----------------------------
        // Ÿà€ïÿ±⁄Øÿ±ÿ™ŸÜ€å Ÿá€ïŸÖŸàŸà ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©ÿßŸÜ ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ
        async function getAllRequests() {
            try {
                const querySnapshot = await getDocs(collection(db2, "Language"));
                const requests = [];
                querySnapshot.forEach((doc) => {
                    requests.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                console.log(`Ÿà€ïÿ±⁄Ø€åÿ±ÿß ${requests.length} ÿØÿßŸàÿß⁄©ÿßÿ±€å ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ`);
                return requests;
            } catch (error) {
                console.error("Ÿá€ï⁄µ€ï ⁄ïŸàŸàÿØÿß ŸÑ€ï Ÿà€ïÿ±⁄Øÿ±ÿ™ŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©ÿßŸÜ ŸÑ€ï ÿØÿßÿ™ÿßÿ®€ï€åÿ≥ ÿØŸàŸÖ:", error);
                return [];
            }
        }
        
        // Export functions to global scope
        window.firebase2Functions = {
            addRequest,
            approveRequest,
            rejectRequest,
            getAllRequests
        };
        
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Noto Sans Arabic', system-ui, -apple-system, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        :root {
            --primary-color: #0F4C75;
            --secondary-color: #3282B8;
            --accent-color: #BBE1FA;
            --light-color: #F9FBFF;
            --dark-color: #1B262C;
            --gray-color: #E8EAED;
            --text-color: #2D3748;
            --success-color: #38B2AC;
            --warning-color: #ED8936;
            --danger-color: #F56565;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --gradient: linear-gradient(135deg, #0F4C75 0%, #3282B8 100%);
            --gradient-accent: linear-gradient(135deg, #3282B8 0%, #BBE1FA 100%);
            
            /* Colors for Dark Mode */
            --dark-bg: #0f172a;
            --dark-card: #1e293b;
            --dark-text: #e5e7eb;
            --dark-border: #334155;
            --dark-primary: #4f46e5;
            --dark-secondary: #22c55e;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
            transition: var(--transition);
            font-size: 15px;
            text-align: right;
            direction: rtl;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background: var(--dark-bg);
            color: var(--dark-text);
        }

        /* ====== HEADER ====== */
        header {
            background: var(--gradient);
            color: white;
            padding: 0.8rem 1rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
            height: 70px;
        }

        body.dark-mode header {
            background: linear-gradient(135deg, var(--dark-primary) 0%, #3730a3 100%);
        }

        .logo {
            flex: 1;
            min-width: 0;
        }

        .logo h1 {
            font-size: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
            line-height: 1.3;
            text-align: right;
            overflow: hidden;
        }

        .logo h1 span:first-child {
            font-weight: 700;
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .welcome-text {
            color: var(--accent-color);
            font-weight: 500;
            font-size: 0.75rem;
            letter-spacing: 0.3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        body.dark-mode .welcome-text {
            color: #93c5fd;
        }

        .admin-login-btn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 0.8rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.4rem;
            backdrop-filter: blur(5px);
            font-size: 0.75rem;
            white-space: nowrap;
            flex-shrink: 0;
            margin-right: 0.5rem;
        }

        .admin-login-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        .admin-login-btn i {
            font-size: 0.9rem;
        }

        /* ====== CONTAINER ====== */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 1rem;
            margin-top: 70px;
            min-height: calc(100vh - 70px);
        }

        /* ====== SEARCH SECTION ====== */
        .search-section {
            background: white;
            padding: 1.2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        body.dark-mode .search-section {
            background: var(--dark-card);
        }

        .search-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient);
        }

        .search-box {
            width: 100%;
            position: relative;
            margin-bottom: 1.2rem;
        }

        .search-box input {
            width: 100%;
            padding: 0.9rem 1rem;
            padding-right: 3rem;
            border: 1.5px solid var(--gray-color);
            border-radius: 10px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: var(--light-color);
            color: var(--text-color);
            font-family: 'Noto Sans Arabic', 'Segoe UI', sans-serif;
        }

        body.dark-mode .search-box input {
            background: #0f172a;
            border-color: var(--dark-border);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(50, 130, 184, 0.1);
        }

        .search-box i {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary-color);
            font-size: 1rem;
        }

        .genre-section {
            width: 100%;
        }

        .genre-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(15, 76, 117, 0.3);
            width: 100%;
            justify-content: center;
        }

        .genre-btn i {
            font-size: 0.9rem;
        }

        .genre-list {
            display: none;
            background: white;
            border: 1.5px solid var(--gray-color);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 0.5rem;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: var(--shadow);
            animation: fadeIn 0.3s ease;
            transition: var(--transition);
        }

        body.dark-mode .genre-list {
            background: var(--dark-card);
            border-color: var(--dark-border);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .genre-list.active {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.5rem;
        }

        .genre-item {
            padding: 0.7rem;
            cursor: pointer;
            border-radius: 8px;
            text-align: center;
            transition: var(--transition);
            background: var(--light-color);
            border: 1px solid transparent;
            font-size: 0.85rem;
            font-weight: 500;
        }

        body.dark-mode .genre-item {
            background: #0f172a;
        }

        .genre-item:hover {
            background: var(--secondary-color);
            color: white;
            transform: translateY(-1px);
        }

        .genre-item.active {
            background: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        body.dark-mode .genre-item.active {
            background: var(--dark-primary);
        }

        /* ====== SECTION HEADER ====== */
        .section-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }

        .section-header h2 {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
            font-weight: 700;
        }

        body.dark-mode .section-header h2 {
            color: var(--dark-primary);
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -6px;
            right: 50%;
            transform: translateX(50%);
            width: 50px;
            height: 3px;
            background: var(--gradient-accent);
            border-radius: 2px;
        }

        .section-header p {
            color: #666;
            font-size: 0.9rem;
            max-width: 100%;
            margin: 0 auto;
            line-height: 1.5;
        }

        body.dark-mode .section-header p {
            color: #cbd5e1;
        }

        /* ====== STATS CONTAINER ====== */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: white;
            padding: 1rem 0.8rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 85px;
        }

        body.dark-mode .stat-card {
            background: var(--dark-card);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.3rem;
            line-height: 1;
        }

        body.dark-mode .stat-number {
            color: var(--dark-primary);
        }

        .stat-label {
            color: #666;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        body.dark-mode .stat-label {
            color: #cbd5e1;
        }

        /* ====== BOOKS GRID ====== */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
            padding: 0.2rem;
        }

        .book-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        body.dark-mode .book-card {
            background: var(--dark-card);
        }

        .book-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .book-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient);
        }

        .book-image {
            width: 100%;
            height: 170px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .book-card:hover .book-image {
            transform: scale(1.05);
        }

        .book-info {
            padding: 0.8rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .book-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(15, 76, 117, 0.95);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: 600;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            border: 1px solid white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        body.dark-mode .book-badge {
            background: rgba(79, 70, 229, 0.95);
        }

        .book-title {
            font-weight: 700;
            margin-bottom: 0.3rem;
            color: var(--dark-color);
            font-size: 0.95rem;
            line-height: 1.3;
            height: 2.5em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        body.dark-mode .book-title {
            color: var(--dark-text);
        }

        .book-genre {
            color: var(--secondary-color);
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 0.2rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        body.dark-mode .book-genre {
            color: var(--dark-primary);
        }

        .book-genre i {
            font-size: 0.7rem;
        }

        /* ====== WISHLIST BUTTON ====== */
        .add-to-wishlist-btn {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: var(--danger-color);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        body.dark-mode .add-to-wishlist-btn {
            background: rgba(30, 41, 59, 0.9);
            color: #fca5a5;
        }

        .add-to-wishlist-btn:hover {
            background: var(--danger-color);
            color: white;
            transform: scale(1.1);
        }

        .add-to-wishlist-btn.in-wishlist {
            background: var(--danger-color);
            color: white;
        }

        /* ====== MODALS ====== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1100;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 95%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            padding: 1.5rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.4s ease;
        }

        body.dark-mode .modal-content {
            background: var(--dark-card);
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close-modal {
            position: absolute;
            top: 0.8rem;
            left: 0.8rem;
            font-size: 1.3rem;
            cursor: pointer;
            color: var(--secondary-color);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
            background: var(--light-color);
            z-index: 1101;
        }

        body.dark-mode .close-modal {
            background: #0f172a;
            color: var(--dark-primary);
        }

        .close-modal:hover {
            background: var(--secondary-color);
            color: white;
            transform: rotate(90deg);
        }

        /* ====== FORMS ====== */
        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.9rem;
            text-align: right;
        }

        body.dark-mode .form-group label {
            color: var(--dark-text);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1.5px solid var(--gray-color);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: var(--transition);
            background: var(--light-color);
            color: var(--text-color);
            font-family: 'Noto Sans Arabic', 'Segoe UI', sans-serif;
            text-align: right;
        }

        body.dark-mode .form-group input,
        body.dark-mode .form-group select,
        body.dark-mode .form-group textarea {
            background: #0f172a;
            border-color: var(--dark-border);
            color: var(--dark-text);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(50, 130, 184, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
            margin-top: 1.5rem;
        }

        .submit-btn, .cancel-btn {
            padding: 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
        }

        .submit-btn {
            background: var(--gradient);
            color: white;
        }

        body.dark-mode .submit-btn {
            background: linear-gradient(135deg, var(--dark-primary) 0%, #3730a3 100%);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(15, 76, 117, 0.3);
        }

        .cancel-btn {
            background: #718096;
            color: white;
        }

        body.dark-mode .cancel-btn {
            background: #475569;
        }

        .cancel-btn:hover {
            background: #4A5568;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(113, 128, 150, 0.3);
        }

        /* ====== ADMIN PANEL ====== */
        #adminPanel {
            margin-top: 70px;
            padding: 1rem;
        }

        .admin-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .admin-action-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 0.9rem;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: var(--shadow);
            text-align: center;
        }

        body.dark-mode .admin-action-btn {
            background: linear-gradient(135deg, var(--dark-primary) 0%, #3730a3 100%);
        }

        .admin-action-btn i {
            font-size: 0.9rem;
        }

        .admin-action-btn.secondary {
            background: #4FD1C7;
        }

        .admin-action-btn.danger {
            background: #FC8181;
        }

        /* ====== ADMIN TABLES ====== */
        .admin-table-container {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: var(--shadow);
            overflow-x: auto;
            margin-bottom: 1.5rem;
            -webkit-overflow-scrolling: touch;
        }

        body.dark-mode .admin-table-container {
            background: var(--dark-card);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
            min-width: 600px;
            font-size: 0.85rem;
        }

        .admin-table th {
            background: var(--gradient);
            color: white;
            padding: 0.8rem;
            text-align: right;
            font-weight: 600;
            border: none;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .admin-table td {
            padding: 0.7rem;
            text-align: right;
            border-bottom: 1px solid var(--gray-color);
            background: white;
            transition: var(--transition);
            white-space: nowrap;
        }

        body.dark-mode .admin-table td {
            background: var(--dark-card);
            border-bottom-color: var(--dark-border);
        }

        .admin-table tr:last-child td {
            border-bottom: none;
        }

        .admin-table tr:hover td {
            background: var(--light-color);
        }

        body.dark-mode .admin-table tr:hover td {
            background: #1e293b;
        }

        /* ====== ACTION BUTTONS ====== */
        .action-btn {
            padding: 0.3rem 0.6rem;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            margin-left: 0.3rem;
            transition: var(--transition);
            font-size: 0.75rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.2rem;
            white-space: nowrap;
        }

        .edit-btn {
            background: var(--accent-color);
            color: var(--dark-color);
        }

        .delete-btn {
            background: #FED7D7;
            color: #C53030;
        }

        .approve-btn {
            background: #C6F6D5;
            color: #276749;
        }

        .reject-btn {
            background: #FEFCBF;
            color: #975A16;
        }

        /* ====== TABS ====== */
        .tabs {
            display: flex;
            gap: 0.3rem;
            margin-bottom: 1.2rem;
            border-bottom: 2px solid var(--gray-color);
            padding-bottom: 0.3rem;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-btn {
            padding: 0.5rem 0.8rem;
            background: none;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-weight: 600;
            color: #718096;
            transition: var(--transition);
            font-size: 0.8rem;
            flex-shrink: 0;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .tab-btn i {
            font-size: 0.8rem;
        }

        .tab-btn.active {
            background: var(--secondary-color);
            color: white;
        }

        body.dark-mode .tab-btn.active {
            background: var(--dark-primary);
        }

        /* ====== WISHLIST SIDEBAR ====== */
        .wishlist-sidebar {
            position: fixed;
            top: 0;
            right: -100%;
            width: 85%;
            max-width: 320px;
            height: 100vh;
            background: white;
            z-index: 1500;
            transition: var(--transition);
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            border-radius: 0;
        }

        body.dark-mode .wishlist-sidebar {
            background: var(--dark-card);
        }

        .wishlist-sidebar.active {
            right: 0;
        }

        .wishlist-header {
            background: var(--gradient);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 0;
        }

        .wishlist-header h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .close-wishlist {
            background: none;
            border: none;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .wishlist-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            -webkit-overflow-scrolling: touch;
        }

        .wishlist-empty {
            text-align: center;
            padding: 2rem 1rem;
            color: #718096;
        }

        .wishlist-empty i {
            font-size: 2.5rem;
            margin-bottom: 0.8rem;
            color: #CBD5E0;
        }

        .wishlist-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            border-radius: 8px;
            background: var(--light-color);
            margin-bottom: 0.7rem;
            transition: var(--transition);
            gap: 0.8rem;
        }

        body.dark-mode .wishlist-item {
            background: #0f172a;
        }

        .wishlist-item-image {
            width: 50px;
            height: 65px;
            object-fit: cover;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .wishlist-item-info {
            flex: 1;
            min-width: 0;
        }

        .wishlist-item-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .wishlist-item-author {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 0.4rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .wishlist-item-actions {
            display: flex;
            gap: 0.4rem;
        }

        .wishlist-remove-btn {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 0.9rem;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .wishlist-borrow-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: var(--transition);
            white-space: nowrap;
        }

        /* ====== TOGGLE BUTTONS ====== */
        .dark-mode-toggle,
        .wishlist-toggle {
            position: fixed;
            left: 15px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode-toggle {
            bottom: 85px;
            background: var(--primary-color);
        }

        .wishlist-toggle {
            bottom: 135px;
            background: linear-gradient(135deg, #f56565 0%, #ed8936 100%);
        }

        .wishlist-count-badge {
            position: absolute;
            top: -3px;
            right: -3px;
            background: var(--danger-color);
            color: white;
            font-size: 0.6rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* ====== FOOTER ====== */
        footer {
            background: var(--dark-color);
            color: white;
            text-align: center;
            padding: 1.5rem 1rem;
            margin-top: 2rem;
            position: relative;
            font-size: 0.85rem;
        }

        body.dark-mode footer {
            background: #0f172a;
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient);
        }

        footer p {
            margin: 0.4rem 0;
            color: #CBD5E0;
            font-size: 0.85rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        footer i {
            margin-left: 0.5rem;
        }

        /* ====== UTILITY CLASSES ====== */
        .empty-state {
            text-align: center;
            padding: 2rem 1rem;
            color: #718096;
        }

        .empty-state i {
            font-size: 2.5rem;
            color: #CBD5E0;
            margin-bottom: 0.8rem;
        }

        .empty-state h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #4A5568;
        }

        body.dark-mode .empty-state h3 {
            color: #cbd5e1;
        }

        .loading {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--primary-color);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--gray-color);
            border-top: 3px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 80px;
            right: 15px;
            padding: 0.8rem 1rem;
            border-radius: 10px;
            color: white;
            z-index: 2000;
            animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            max-width: 300px;
            font-size: 0.85rem;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .success-notification {
            background: var(--success-color);
            border-left: 3px solid #2C7A7B;
        }

        .error-notification {
            background: var(--danger-color);
            border-left: 3px solid #C53030;
        }

        .warning-notification {
            background: var(--warning-color);
            border-left: 3px solid #DD6B20;
        }

        .badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }

        .status-pending {
            background: #FEF3C7;
            color: #92400E;
        }

        .status-approved {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-rejected {
            background: #FEE2E2;
            color: #991B1B;
        }

        /* ====== SCROLLBAR ====== */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-color);
            border-radius: 3px;
        }

        body.dark-mode ::-webkit-scrollbar-track {
            background: var(--dark-border);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 3px;
        }

        body.dark-mode ::-webkit-scrollbar-thumb {
            background: var(--dark-primary);
        }

        /* ====== RESPONSIVE DESIGN ====== */
        @media (min-width: 768px) {
            .container {
                max-width: 1200px;
                padding: 2rem;
                margin-top: 80px;
            }
            
            header {
                padding: 1rem 2rem;
                height: 80px;
            }
            
            .logo h1 {
                font-size: 1.4rem;
            }
            
            .welcome-text {
                font-size: 0.9rem;
            }
            
            .admin-login-btn {
                padding: 0.7rem 1.5rem;
                font-size: 0.9rem;
            }
            
            .search-section {
                padding: 2rem;
            }
            
            .section-header h2 {
                font-size: 2rem;
            }
            
            .section-header p {
                font-size: 1rem;
            }
            
            .stats-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.5rem;
            }
            
            .stat-card {
                padding: 1.5rem;
            }
            
            .stat-number {
                font-size: 2.2rem;
            }
            
            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1.5rem;
                padding: 0.5rem;
            }
            
            .book-image {
                height: 250px;
            }
            
            .admin-actions {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .wishlist-sidebar {
                width: 380px;
            }
            
            .dark-mode-toggle {
                width: 50px;
                height: 50px;
                font-size: 18px;
                bottom: 100px;
                left: 20px;
            }
            
            .wishlist-toggle {
                width: 50px;
                height: 50px;
                font-size: 18px;
                bottom: 160px;
                left: 20px;
            }
        }

        @media (max-width: 360px) {
            .books-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }
            
            .stat-card {
                min-height: 75px;
                padding: 1rem 0.5rem;
            }
            
            .stat-number {
                font-size: 1.6rem;
            }
            
            .genre-list.active {
                grid-template-columns: 1fr;
            }
            
            .admin-table {
                font-size: 0.8rem;
            }
            
            .action-btn {
                font-size: 0.7rem;
                padding: 0.25rem 0.5rem;
            }
        }

        /* ====== TOUCH OPTIMIZATIONS ====== */
        @media (hover: none) {
            button:hover {
                transform: none !important;
            }
            
            .book-card:hover {
                transform: none !important;
            }
            
            .genre-item:hover {
                transform: none !important;
                background: var(--light-color) !important;
                color: var(--text-color) !important;
            }
            
            body.dark-mode .genre-item:hover {
                background: #0f172a !important;
                color: var(--dark-text) !important;
            }
            
            .genre-item.active:hover {
                background: var(--secondary-color) !important;
                color: white !important;
            }
        }

        /* ====== FIX FOR MOBILE INPUT ZOOM ====== */
        @media screen and (max-width: 767px) {
            input,
            select,
            textarea {
                font-size: 16px !important;
            }
            
            .search-box input {
                font-size: 16px !important;
            }
        }

        /* ====== FIX FOR MODAL SCROLL ====== */
        .modal-content {
            -webkit-overflow-scrolling: touch;
        }

        /* ====== FIX FOR BUTTON TAP HIGHLIGHT ====== */
        button {
            -webkit-tap-highlight-color: transparent;
        }

        /* ====== FIX FOR TABLE DISPLAY ON MOBILE ====== */
        @media (max-width: 767px) {
            .admin-table th,
            .admin-table td {
                padding: 0.6rem 0.4rem;
                font-size: 0.8rem;
            }
            
            .admin-table th:nth-child(1),
            .admin-table td:nth-child(1),
            .admin-table th:nth-child(6),
            .admin-table td:nth-child(6),
            .admin-table th:nth-child(7),
            .admin-table td:nth-child(7),
            .admin-table th:nth-child(8),
            .admin-table td:nth-child(8) {
                display: none;
            }
            
            .admin-table {
                min-width: 500px;
            }
        }

        @media (max-width: 480px) {
            .admin-table th:nth-child(3),
            .admin-table td:nth-child(3),
            .admin-table th:nth-child(4),
            .admin-table td:nth-child(4) {
                display: none;
            }
            
            .admin-table {
                min-width: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- ÿØÿß⁄ï⁄© ŸÖ€ÜÿØ ÿ™ŸàŸà⁄Ø⁄µ -->
    <button id="darkModeToggle" class="dark-mode-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- ÿØŸà⁄ØŸÖ€ï€å ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ -->
    <button id="wishlistToggle" class="wishlist-toggle">
        <i class="fas fa-heart"></i>
        <span class="wishlist-count-badge" id="wishlistCount">0</span>
    </button>

    <!-- ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ -->
    <div class="wishlist-sidebar" id="wishlistSidebar">
        <div class="wishlist-header">
            <h3><i class="fas fa-heart"></i> ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜŸÖ</h3>
            <button class="close-wishlist" id="closeWishlist">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="wishlist-content" id="wishlistContent">
            <div class="wishlist-empty" id="emptyWishlist">
                <i class="fas fa-heart-broken"></i>
                <h3>ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜÿ™ ÿ®€ïÿ™ÿß⁄µ€ï</h3>
                <p>⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ€å ÿÆ€Üÿ≤€ïÿ¥ÿ™ ⁄©ŸÑ€å⁄©€å "‚ù§Ô∏è" ÿ®⁄©€ï ÿ®€Ü ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€åÿßŸÜ</p>
            </div>
        </div>
    </div>

    <header>
        <div class="logo">
            <h1>
                <span>⁄©ÿ™€éÿ®ÿÆÿßŸÜ€ï€å ⁄©€ÜŸÑ€é⁄ò€å ÿ≥⁄µÿßÿ≠€ïÿØ€åŸÜ</span>
                <span class="welcome-text">ÿ®€ïÿ¥€å ÿ≤ŸÖÿßŸÜ - ÿ≥€ïÿ±⁄ÜÿßŸà€ï€å ÿ≤ÿßŸÜÿ≥ÿ™ Ÿà ÿ≤ÿßŸÜ€åÿßÿ±€å</span>
            </h1>
        </div>
        <button class="admin-login-btn" id="adminLoginBtn">
            <i class="fas fa-user-shield"></i> ÿ¶€ïÿØŸÖ€åŸÜ
        </button>
    </header>

    <div class="container">
        <section class="search-section">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="⁄Ø€ï⁄ïÿßŸÜ ÿ®€Ü ⁄©ÿ™€éÿ®ÿå ŸÜŸàŸàÿ≥€ïÿ±ÿå €åÿßŸÜ ÿ®€ïÿ¥...">
                <i class="fas fa-search"></i>
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            
            <div class="genre-section">
                <button class="genre-btn" id="genreToggleBtn">
                    <i class="fas fa-filter"></i> ŸÅ€åŸÑÿ™€ïÿ± ÿ®€ï ⁄òÿßŸÜ€ïÿ±
                </button>
                <div class="genre-list" id="genreList">
                    <div class="genre-item active" data-genre="all">üìö Ÿá€ïŸÖŸàŸà ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ</div>
                    <div class="genre-item" data-genre="ŸÖ€é⁄òŸàŸà">üìú ŸÖ€é⁄òŸàŸà</div>
                    <div class="genre-item" data-genre="⁄ï€ÜŸÖÿßŸÜ">üìñ ⁄ï€ÜŸÖÿßŸÜ</div>
                    <div class="genre-item" data-genre="ÿ¶ÿß€åŸÜ€å">üïå ÿ¶ÿß€åŸÜ€å</div>
                    <div class="genre-item" data-genre="ÿ≥€åÿßÿ≥€å">üèõÔ∏è ÿ≥€åÿßÿ≥€å</div>
                    <div class="genre-item" data-genre="ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ">üó£Ô∏è ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ</div>
                    <div class="genre-item" data-genre="ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ™€ï⁄©ŸÜ€ïŸÑ€Ü⁄ò€åÿß">üíª ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ™€ï⁄©ŸÜ€ïŸÑ€Ü⁄ò€åÿß</div>
                    <div class="genre-item" data-genre="ÿ™ÿ±ÿ≥ŸÜÿß⁄©">üëª ÿ™ÿ±ÿ≥ŸÜÿß⁄©</div>
                    <div class="genre-item" data-genre="ÿ≤ÿßŸÜÿ≥ÿ™€å">üî¨ ÿ≤ÿßŸÜÿ≥ÿ™€å</div>
                    <div class="genre-item" data-genre="ŸÅ€ïŸÑÿ≥€ïŸÅ€ï">üß† ŸÅ€ïŸÑÿ≥€ïŸÅ€ï</div>
                    <div class="genre-item" data-genre="ŸáŸàŸÜ€ïÿ±€å">üé® ŸáŸàŸÜ€ïÿ±€å</div>
                    <div class="genre-item" data-genre="ÿ™€ïŸÜÿØÿ±Ÿàÿ≥ÿ™€å">üè• ÿ™€ïŸÜÿØÿ±Ÿàÿ≥ÿ™€å</div>
                </div>
            </div>
        </section>

        <section class="books-section">
            <div class="section-header">
                <h2 id="booksSectionTitle">⁄©ÿ™€éÿ®€ï ŸÜŸà€é€å€ï⁄©ÿßŸÜ</h2>
                <p>ÿØ€Üÿ≤€åŸÜ€ïŸà€ï€å ⁄©ÿ™€éÿ®€å ÿØŸÑÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜÿ™ ŸÑ€ï ⁄©ÿ™€éÿ®ÿÆÿßŸÜ€ï€å ÿ≥€ïÿ±ÿØ€ïŸÖ€åŸÖÿßŸÜ</p>
            </div>
            
            <!-- ÿ¶ÿßŸÖÿßÿ±€ï⁄©ÿßŸÜ - 1 rows 3 colom -->
            <div class="stats-container" id="statsContainer">
                <div class="stat-card">
                    <div class="stat-number" id="totalBooks">0</div>
                    <div class="stat-label">⁄©€Ü€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="borrowedBooks">0</div>
                    <div class="stat-label">⁄©ÿ™€éÿ®€ï Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï⁄©ÿßŸÜ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="wishlistTotal">0</div>
                    <div class="stat-label">⁄©ÿ™€éÿ® ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ŸÖŸÜ</div>
                </div>
            </div>

            <div class="books-grid" id="booksGrid">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>ÿ®ÿßÿ±⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ...</p>
                </div>
            </div>
        </section>

        <section class="registration-form" id="registrationForm">
            <h2 style="color: var(--primary-color); margin-bottom: 1.2rem;">üìù ÿ™€ÜŸÖÿßÿ±⁄©ÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å ⁄©ÿ™€éÿ®</h2>
            <form id="studentRegistrationForm">
                <div class="form-group">
                    <label for="regStudentName"><i class="fas fa-user"></i> ŸÜÿßŸà€å ÿ≥€åÿßŸÜ€å</label>
                    <input type="text" id="regStudentName" placeholder="ŸÜÿßŸà€å ÿ™€ïŸàÿßŸà€å ÿÆ€Üÿ™ ÿ®ŸÜŸàŸàÿ≥€ï" required>
                </div>
                <div class="form-group">
                    <label for="regDepartment"><i class="fas fa-building"></i> ŸÜÿßŸà€å ÿ®€ïÿ¥</label>
                    <input type="text" id="regDepartment" placeholder="ŸÜÿßŸà€å ÿ®€ïÿ¥€å ÿÆŸà€éŸÜÿØŸÜ" required>
                </div>
                <div class="form-group">
                    <label for="regStage"><i class="fas fa-graduation-cap"></i> ŸÇ€ÜŸÜÿßÿ∫€å ÿÆŸà€éŸÜÿØŸÜ</label>
                    <select id="regStage" required>
                        <option value="">-- ŸÇ€ÜŸÜÿßÿ∫ Ÿá€ï⁄µÿ®⁄ò€éÿ±€ï --</option>
                        <option value="€å€ï⁄©€ïŸÖ">€å€ï⁄©€ïŸÖ</option>
                        <option value="ÿØŸàŸà€ïŸÖ">ÿØŸàŸà€ïŸÖ</option>
                        <option value="ÿ≥€é€å€ïŸÖ">ÿ≥€é€å€ïŸÖ</option>
                        <option value="⁄ÜŸàÿßÿ±€ïŸÖ">⁄ÜŸàÿßÿ±€ïŸÖ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="regPhoneNumber"><i class="fas fa-phone"></i> ⁄òŸÖÿßÿ±€ï€å ŸÖ€Üÿ®ÿß€åŸÑ</label>
                    <input type="tel" id="regPhoneNumber" placeholder="Ÿ†ŸßŸ†Ÿ† Ÿ°Ÿ¢Ÿ£ Ÿ§Ÿ•Ÿ¶Ÿß" required>
                </div>
                <input type="hidden" id="regBookId">
                <input type="hidden" id="regBookTitle">
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> ŸÜÿßÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å
                    </button>
                    <button type="button" class="cancel-btn" id="cancelRegistrationBtn">
                        <i class="fas fa-times"></i> Ÿá€ï⁄µŸà€ïÿ¥ÿßŸÜÿØŸÜ€ïŸà€ï
                    </button>
                </div>
            </form>
            <div class="confirmation-message" id="confirmationMessage">
                <i class="fas fa-check-circle"></i> ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©€ïÿ™ ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ŸÜ€éÿ±ÿØÿ±ÿß! ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ€å Ÿæ€ïÿ≥€ïŸÜÿØ⁄©ÿ±ÿØŸÜ€å ÿ¶€ïÿØŸÖ€åŸÜ ÿ®€ï
            </div>
        </section>
    </div>

    <!-- Modals -->
    <div class="modal" id="bookDetailsModal">
        <div class="modal-content">
            <span class="close-modal" id="closeBookModal">&times;</span>
            <div class="book-details" id="bookDetailsContent"></div>
        </div>
    </div>

    <div class="modal" id="adminLoginModal">
        <div class="modal-content">
            <span class="close-modal" id="closeLoginModal">&times;</span>
            <h2>üîê ⁄ÜŸàŸàŸÜ€ï ⁄òŸàŸàÿ±€ïŸà€ï€å ÿ¶€ïÿØŸÖ€åŸÜ</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminUsername"><i class="fas fa-user-circle"></i> ŸÜÿßŸà€å ÿ®€ï⁄©ÿßÿ±Ÿá€éŸÜ€ïÿ±</label>
                    <input type="text" id="adminUsername" placeholder="ŸÜÿßŸà€å ÿ®€ï⁄©ÿßÿ±Ÿá€éŸÜ€ïÿ± ÿ®ŸÜŸàŸàÿ≥€ï" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword"><i class="fas fa-lock"></i> Ÿàÿ¥€ï€å ŸÜŸá€éŸÜ€å</label>
                    <input type="password" id="adminPassword" placeholder="Ÿàÿ¥€ï€å ŸÜŸá€éŸÜ€å ÿ®ŸÜŸàŸàÿ≥€ï" required>
                </div>
                <div class="error-message" id="loginError">
                    <i class="fas fa-exclamation-triangle"></i> ŸÜÿßŸà€å ÿ®€ï⁄©ÿßÿ±Ÿá€éŸÜ€ïÿ± €åÿßŸÜ Ÿàÿ¥€ï€å ŸÜŸá€éŸÜ€å Ÿá€ï⁄µ€ï€å€ï
                </div>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-sign-in-alt"></i> ⁄ÜŸàŸàŸÜ€ï ⁄òŸàŸàÿ±€ïŸà€ï
                    </button>
                    <button type="button" class="cancel-btn" id="cancelLoginBtn">
                        <i class="fas fa-times"></i> Ÿá€ï⁄µŸà€ïÿ¥ÿßŸÜÿØŸÜ€ïŸà€ï
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="container" id="adminPanel" style="display: none;">
        <div class="section-header">
            <h2>‚öôÔ∏è Ÿæ€ï⁄ï€ï€å ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ÿ¶€ïÿØŸÖ€åŸÜ</h2>
            <p>ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ Ÿà ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©ÿßŸÜ€å ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±ÿßŸÜ</p>
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="adminTotalBooks">0</div>
                <div class="stat-label">⁄©€Ü€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="adminPendingRequests">0</div>
                <div class="stat-label">ÿØÿßŸàÿß⁄©ÿßÿ±€å ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="adminApprovedRequests">0</div>
                <div class="stat-label">⁄©ÿ™€éÿ®€ï Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï⁄©ÿßŸÜ</div>
            </div>
        </div>
        
        <div class="admin-actions">
            <button class="admin-action-btn" id="addBookBtn">
                <i class="fas fa-plus-circle"></i> ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€å ŸÜŸà€é
            </button>
            <button class="admin-action-btn" id="viewRegisteredStudentsBtn">
                <i class="fas fa-users-cog"></i> ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±€ï ÿØÿßŸàÿß⁄©ÿßÿ±€ï⁄©ÿßŸÜ
            </button>
            <button class="admin-action-btn secondary" id="viewBooksBtn">
                <i class="fas fa-book"></i> ÿ®€åŸÜ€åŸÜ€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ
            </button>
            <button class="admin-action-btn" id="returnBookBtn">
                <i class="fas fa-undo-alt"></i> ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï€å ⁄©ÿ™€éÿ®
            </button>
            <button class="admin-action-btn danger" id="backToMainBtn">
                <i class="fas fa-arrow-left"></i> ⁄Ø€ï⁄ïÿßŸÜ€ïŸà€ï ÿ®€Ü Ÿæ€ï⁄ï€ï€å ÿ≥€ïÿ±€ï⁄©€å
            </button>
        </div>

        <div id="bookManagementSection">
            <div class="section-header" style="margin-bottom: 1.2rem;">
                <h3>üìö ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ</h3>
            </div>
            <div class="search-box" style="margin-bottom: 1.2rem;">
                <input type="text" id="adminSearchInput" placeholder="⁄Ø€ï⁄ïÿßŸÜ ÿ®€Ü ⁄©ÿ™€éÿ®...">
                <i class="fas fa-search"></i>
                <div class="search-suggestions" id="adminSearchSuggestions"></div>
            </div>
            <div class="admin-table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Ÿà€éŸÜ€ï</th>
                            <th>ŸÜÿßŸà€å ⁄©ÿ™€éÿ®</th>
                            <th>ŸÜŸàŸàÿ≥€ïÿ±</th>
                            <th>⁄òÿßŸÜ€ïÿ±</th>
                            <th>ÿ®ÿßÿ±ŸàÿØ€ÜÿÆ</th>
                            <th>⁄©ÿ±ÿØÿßÿ±€ï⁄©ÿßŸÜ</th>
                        </tr>
                    </thead>
                    <tbody id="adminBooksTable"></tbody>
                </table>
            </div>
        </div>

        <div id="registeredStudentsSection" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.2rem;">
                <div class="section-header" style="margin: 0;">
                    <h3>üë• ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±€ï ÿØÿßŸàÿß⁄©ÿßÿ±€ï⁄©ÿßŸÜ</h3>
                </div>
                <div class="tabs">
                    <button class="tab-btn active" id="showPendingBtn">
                        <i class="fas fa-clock"></i> ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ
                    </button>
                    <button class="tab-btn" id="showApprovedBtn">
                        <i class="fas fa-check-circle"></i> Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï⁄©ÿßŸÜ
                    </button>
                    <button class="tab-btn" id="showReturnedBtn">
                        <i class="fas fa-undo-alt"></i> ⁄Ø€ï⁄ï€éŸÜÿØÿ±ÿßŸà€ï⁄©ÿßŸÜ
                    </button>
                </div>
            </div>
            
            <div class="search-box" style="margin-bottom: 1.2rem;">
                <input type="text" id="studentSearchInput" placeholder="⁄Ø€ï⁄ïÿßŸÜ ÿ®€Ü ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±...">
                <i class="fas fa-search"></i>
                <div class="search-suggestions" id="studentSearchSuggestions"></div>
            </div>
            
            <div class="admin-table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ŸÜÿßŸà€å ÿ≥€åÿßŸÜ€å</th>
                            <th>ÿ®€ïÿ¥</th>
                            <th>ŸÇ€ÜŸÜÿßÿ∫</th>
                            <th>ŸÖ€Üÿ®ÿß€åŸÑ</th>
                            <th>⁄©ÿ™€éÿ®</th>
                            <th>ÿ®€ïÿ±Ÿàÿßÿ±€å ÿØÿßŸàÿß⁄©ÿ±ÿØŸÜ</th>
                            <th>ÿ®ÿßÿ±ŸàÿØ€ÜÿÆ</th>
                            <th>⁄©ÿ±ÿØÿßÿ±€ï⁄©ÿßŸÜ</th>
                        </tr>
                    </thead>
                    <tbody id="registeredStudentsTable"></tbody>
                </table>
            </div>
        </div>

        <div id="returnBookSection" style="display: none;">
            <div class="section-header" style="margin-bottom: 1.2rem;">
                <h3>üîÑ ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï€å ⁄©ÿ™€éÿ®</h3>
                <p>ŸÜ€åÿ¥ÿßŸÜÿØÿßŸÜ€å ⁄©ÿ™€éÿ®€ï Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï⁄©ÿßŸÜ Ÿà ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï€å€ï⁄©€åÿßŸÜ</p>
            </div>
            
            <div class="search-box" style="margin-bottom: 1.2rem;">
                <input type="text" id="returnSearchInput" placeholder="⁄Ø€ï⁄ïÿßŸÜ ÿ®€Ü ⁄©ÿ™€éÿ® €åÿßŸÜ ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±...">
                <i class="fas fa-search"></i>
                <div class="search-suggestions" id="returnSearchSuggestions"></div>
            </div>
            
            <div class="admin-table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ŸÜÿßŸà€å ÿ≥€åÿßŸÜ€å</th>
                            <th>ÿ®€ïÿ¥</th>
                            <th>ŸÖ€Üÿ®ÿß€åŸÑ</th>
                            <th>⁄©ÿ™€éÿ®</th>
                            <th>ÿ®€ïÿ±Ÿàÿßÿ±€å Ÿà€ïÿ±⁄Øÿ±ÿ™ŸÜ</th>
                            <th>ŸÖÿßŸà€ï€å Ÿà€ïÿ±⁄Øÿ±ÿ™ŸÜ</th>
                            <th>⁄©ÿ±ÿØÿßÿ±€ï⁄©ÿßŸÜ</th>
                        </tr>
                    </thead>
                    <tbody id="returnBooksTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="modal" id="bookFormModal">
        <div class="modal-content">
            <span class="close-modal" id="closeBookFormModal">&times;</span>
            <h2 id="bookFormTitle">üìñ ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€å ŸÜŸà€é</h2>
            <form id="bookForm">
                <div class="form-group">
                    <label for="bookTitle"><i class="fas fa-heading"></i> ŸÜÿßŸà€å ⁄©ÿ™€éÿ®</label>
                    <input type="text" id="bookTitle" placeholder="ŸÜÿßŸà€å ⁄©ÿ™€éÿ® ÿ®ŸÜŸàŸàÿ≥€ï" required>
                </div>
                <div class="form-group">
                    <label for="bookAuthor"><i class="fas fa-user-edit"></i> ŸÜÿßŸà€å ŸÜŸàŸàÿ≥€ïÿ±</label>
                    <input type="text" id="bookAuthor" placeholder="ŸÜÿßŸà€å ŸÜŸàŸàÿ≥€ïÿ± ÿ®ŸÜŸàŸàÿ≥€ï" required>
                </div>
                <div class="form-group">
                    <label for="bookGenre"><i class="fas fa-tags"></i> ⁄òÿßŸÜ€ïÿ±€å ⁄©ÿ™€éÿ®</label>
                    <select id="bookGenre" required>
                        <option value="">-- ⁄òÿßŸÜ€ïÿ± Ÿá€ï⁄µÿ®⁄ò€éÿ±€ï --</option>
                        <option value="ŸÖ€é⁄òŸàŸà">ŸÖ€é⁄òŸàŸà</option>
                        <option value="⁄ï€ÜŸÖÿßŸÜ">⁄ï€ÜŸÖÿßŸÜ</option>
                        <option value="ÿ¶ÿß€åŸÜ€å">ÿ¶ÿß€åŸÜ€å</option>
                        <option value="ÿ≥€åÿßÿ≥€å">ÿ≥€åÿßÿ≥€å</option>
                        <option value="ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ">ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ</option>
                        <option value="ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ™€ï⁄©ŸÜ€ïŸÑ€Ü⁄ò€åÿß">ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ™€ï⁄©ŸÜ€ïŸÑ€Ü⁄ò€åÿß</option>
                        <option value="ÿ™ÿ±ÿ≥ŸÜÿß⁄©">ÿ™ÿ±ÿ≥ŸÜÿß⁄©</option>
                        <option value="ÿ≤ÿßŸÜÿ≥ÿ™€å">ÿ≤ÿßŸÜÿ≥ÿ™€å</option>
                        <option value="ŸÅ€ïŸÑÿ≥€ïŸÅ€ï">ŸÅ€ïŸÑÿ≥€ïŸÅ€ï</option>
                        <option value="ŸáŸàŸÜ€ïÿ±€å">ŸáŸàŸÜ€ïÿ±€å</option>
                        <option value="ÿ™€ïŸÜÿØÿ±Ÿàÿ≥ÿ™€å">ÿ™€ïŸÜÿØÿ±Ÿàÿ≥ÿ™€å</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="bookSummary"><i class="fas fa-align-left"></i> ⁄©Ÿàÿ±ÿ™€ï€å ⁄©ÿ™€éÿ®</label>
                    <textarea id="bookSummary" rows="4" placeholder="⁄©Ÿàÿ±ÿ™€ï€å€ï⁄© ÿØ€ïÿ±ÿ®ÿßÿ±€ï€å ŸÜÿßŸà€ï⁄ï€Ü⁄©€å ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ®ŸÜŸàŸàÿ≥€ï..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="bookImage"><i class="fas fa-image"></i> ŸÑ€åŸÜ⁄©€å Ÿà€éŸÜ€ï€å ⁄©ÿ™€éÿ®</label>
                    <input type="text" id="bookImage" placeholder="ŸÑ€åŸÜ⁄©€å Ÿà€éŸÜ€ï (URL)" required>
                </div>
                <input type="hidden" id="bookId">
                <div class="form-buttons">
                    <button type="submit" class="submit-btn" id="bookFormSubmitBtn">
                        <i class="fas fa-save"></i> Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™
                    </button>
                    <button type="button" class="cancel-btn" id="cancelBookFormBtn">
                        <i class="fas fa-times"></i> Ÿá€ï⁄µŸà€ïÿ¥ÿßŸÜÿØŸÜ€ïŸà€ï
                    </button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <h3 style="color: white; margin-bottom: 0.8rem; font-size: 1.1rem;">⁄©ÿ™€éÿ®ÿÆÿßŸÜ€ï€å ⁄©€ÜŸÑ€é⁄ò€å ÿ≥⁄µÿßÿ≠€ïÿØ€åŸÜ</h3>
            <p><i class="fas fa-map-marker-alt"></i> Ÿá€ïŸàŸÑ€éÿ±ÿå ⁄©€ÜŸÑ€é⁄ò€å ÿ≥⁄µÿßÿ≠€ïÿØ€åŸÜ - ÿ®€ïÿ¥€å ÿ≤ŸÖÿßŸÜ</p>
            <p><i class="fas fa-envelope"></i> library@salahaddin.edu.krd</p>
            <p><i class="fas fa-phone"></i> Ÿ†ŸßŸ•Ÿ† Ÿ°Ÿ¢Ÿ£ Ÿ§Ÿ•Ÿ¶Ÿß</p>
            <div style="margin-top: 1.2rem; padding-top: 0.8rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                <p>¬© Ÿ¢Ÿ†Ÿ¢Ÿ§ ⁄©ÿ™€éÿ®ÿÆÿßŸÜ€ï€å ⁄©€ÜŸÑ€é⁄ò€å ÿ≥⁄µÿßÿ≠€ïÿØ€åŸÜ - ÿ®€ïÿ¥€å ÿ≤ŸÖÿßŸÜ. Ÿá€ïŸÖŸàŸà ŸÖÿßŸÅ€ï⁄©ÿßŸÜ Ÿæÿßÿ±€éÿ≤ÿ±ÿßŸàŸÜ.</p>
                <p style="color: #CBD5E0; font-size: 0.8rem; margin-top: 0.5rem;">
                    <i class="fas fa-heart" style="color: #F56565;"></i> ÿØÿ±Ÿàÿ≥ÿ™⁄©ÿ±ÿßŸà€ï ÿ®€ï ÿÆ€Üÿ¥€ïŸà€åÿ≥ÿ™€å ÿ®€Ü ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±ÿßŸÜ€å ⁄©Ÿàÿ±ÿØÿ≥ÿ™ÿßŸÜ
                </p>
            </div>
        </div>
    </footer>

    <script>
        // ÿØÿß⁄ï⁄© ŸÖ€ÜÿØ ÿ™ŸàŸà⁄Ø⁄µ
        const darkModeToggle = document.getElementById('darkModeToggle');
        const darkModeIcon = darkModeToggle.querySelector('i');
        
        // ÿ®ÿßÿ±⁄©ÿ±ÿØŸÜ€å Ÿá€ï⁄µÿ®⁄òÿßÿ±ÿØ€ï€å Ÿæ€éÿ¥ŸàŸà
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            darkModeIcon.className = 'fas fa-sun';
        }
        
        // ⁄Ø€Ü⁄ï€åŸÜ€å ÿØÿß⁄ï⁄© ŸÖ€ÜÿØ
        darkModeToggle.onclick = () => {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                darkModeIcon.className = 'fas fa-sun';
                showNotification('üåô ÿØÿß⁄ï⁄© ŸÖ€ÜÿØ ⁄ÜÿßŸÑÿß⁄©⁄©ÿ±ÿß', 'success');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                darkModeIcon.className = 'fas fa-moon';
                showNotification('‚òÄÔ∏è ⁄ïŸàŸàŸÜÿß⁄© ŸÖ€ÜÿØ ⁄ÜÿßŸÑÿß⁄©⁄©ÿ±ÿß', 'success');
            }
        };
        
        // DOM Elements
        const adminLoginBtn = document.getElementById('adminLoginBtn');
        const adminLoginModal = document.getElementById('adminLoginModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const cancelLoginBtn = document.getElementById('cancelLoginBtn');
        const adminLoginForm = document.getElementById('adminLoginForm');
        const loginError = document.getElementById('loginError');
        
        const adminPanel = document.getElementById('adminPanel');
        const backToMainBtn = document.getElementById('backToMainBtn');
        const viewBooksBtn = document.getElementById('viewBooksBtn');
        const returnBookBtn = document.getElementById('returnBookBtn');
        
        const genreToggleBtn = document.getElementById('genreToggleBtn');
        const genreList = document.getElementById('genreList');
        const searchInput = document.getElementById('searchInput');
        const searchSuggestions = document.getElementById('searchSuggestions');
        
        const booksGrid = document.getElementById('booksGrid');
        const booksSectionTitle = document.getElementById('booksSectionTitle');
        const statsContainer = document.getElementById('statsContainer');
        
        const bookDetailsModal = document.getElementById('bookDetailsModal');
        const closeBookModal = document.getElementById('closeBookModal');
        
        const registrationForm = document.getElementById('registrationForm');
        const studentRegistrationForm = document.getElementById('studentRegistrationForm');
        const cancelRegistrationBtn = document.getElementById('cancelRegistrationBtn');
        const confirmationMessage = document.getElementById('confirmationMessage');
        
        const bookFormModal = document.getElementById('bookFormModal');
        const closeBookFormModal = document.getElementById('closeBookFormModal');
        const cancelBookFormBtn = document.getElementById('cancelBookFormBtn');
        const bookForm = document.getElementById('bookForm');
        const bookFormTitle = document.getElementById('bookFormTitle');
        const bookFormSubmitBtn = document.getElementById('bookFormSubmitBtn');
        
        const addBookBtn = document.getElementById('addBookBtn');
        const viewRegisteredStudentsBtn = document.getElementById('viewRegisteredStudentsBtn');
        const showPendingBtn = document.getElementById('showPendingBtn');
        const showApprovedBtn = document.getElementById('showApprovedBtn');
        const showReturnedBtn = document.getElementById('showReturnedBtn');
        
        const bookManagementSection = document.getElementById('bookManagementSection');
        const registeredStudentsSection = document.getElementById('registeredStudentsSection');
        const returnBookSection = document.getElementById('returnBookSection');
        
        const adminBooksTable = document.getElementById('adminBooksTable');
        const registeredStudentsTable = document.getElementById('registeredStudentsTable');
        const returnBooksTable = document.getElementById('returnBooksTable');
        const adminSearchInput = document.getElementById('adminSearchInput');
        const adminSearchSuggestions = document.getElementById('adminSearchSuggestions');
        const studentSearchInput = document.getElementById('studentSearchInput');
        const studentSearchSuggestions = document.getElementById('studentSearchSuggestions');
        const returnSearchInput = document.getElementById('returnSearchInput');
        const returnSearchSuggestions = document.getElementById('returnSearchSuggestions');

        // ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ - Elements
        const wishlistToggle = document.getElementById('wishlistToggle');
        const wishlistSidebar = document.getElementById('wishlistSidebar');
        const closeWishlist = document.getElementById('closeWishlist');
        const wishlistContent = document.getElementById('wishlistContent');
        const emptyWishlist = document.getElementById('emptyWishlist');
        const wishlistCount = document.getElementById('wishlistCount');
        const wishlistTotalStat = document.getElementById('wishlistTotal');
        const borrowedBooksStat = document.getElementById('borrowedBooks');
        const totalBooksStat = document.getElementById('totalBooks');

        // Application State
        let currentUser = null;
        let books = [];
        let allRequests = [];
        let approvedRequests = [];
        let wishlist = [];
        let currentGenre = 'all';
        let currentSearch = '';
        let editingBookId = null;
        let currentStudentView = 'pending';

        // Admin Credentials
        const ADMIN_USERNAME = '1981Language2026';
        const ADMIN_PASSWORD = 'S1981S';

        // Status Types
        const STATUS = {
            PENDING: 'pending',
            APPROVED: 'approved',
            RETURNED: 'returned',
            REJECTED: 'rejected'
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', async function() {
            if (!window.firebase) {
                booksGrid.innerHTML = '<div class="empty-state"><i class="fas fa-exclamation-triangle"></i><h3>Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ÿ®ÿßÿ±⁄©ÿ±ÿØŸÜ€å ÿ≥€ïÿ±⁄ÜÿßŸà€ï⁄©ÿßŸÜ</h3><p>ÿ™⁄©ÿß€å€ï ÿØŸàŸàÿ®ÿßÿ±€ï Ÿá€ïŸà⁄µÿ®ÿØ€ïÿ±€ïŸà€ï €åÿßŸÜ Ÿæ€ï€åŸà€ïŸÜÿØ€å ÿ®⁄©€ï ÿ®€ï ÿ®€ï⁄ï€éŸà€ïÿ®€ïÿ±€ïŸà€ï</p></div>';
                return;
            }
            
            setupEventListeners();
            loadWishlistFromLocalStorage();
            await loadBooksFromFirebase();
            await loadAllRequests();
            displayBooks();
            updateWishlistCount();
            updateWishlistUI();
        });

        // Set up event listeners
        function setupEventListeners() {
            // Admin login
            adminLoginBtn.addEventListener('click', () => {
                adminLoginModal.classList.add('active');
            });
            
            closeLoginModal.addEventListener('click', () => {
                adminLoginModal.classList.remove('active');
                loginError.style.display = 'none';
            });
            
            cancelLoginBtn.addEventListener('click', () => {
                adminLoginModal.classList.remove('active');
                loginError.style.display = 'none';
            });
            
            adminLoginForm.addEventListener('submit', handleAdminLogin);
            
            // Genre toggle
            genreToggleBtn.addEventListener('click', () => {
                genreList.classList.toggle('active');
            });
            
            // Genre selection
            document.querySelectorAll('.genre-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.genre-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    currentGenre = item.getAttribute('data-genre');
                    booksSectionTitle.textContent = currentGenre === 'all' ? '⁄©ÿ™€éÿ®€ï ŸÜŸà€é€å€ï⁄©ÿßŸÜ' : `⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ€å ${currentGenre}`;
                    genreList.classList.remove('active');
                    displayBooks();
                });
            });
            
            // Search functionality
            searchInput.addEventListener('input', (e) => {
                currentSearch = e.target.value.toLowerCase();
                
                if (currentSearch.trim() !== '') {
                    showSearchSuggestions(currentSearch, searchSuggestions);
                } else {
                    searchSuggestions.classList.remove('active');
                }
                
                displayBooks();
            });
            
            // ⁄©ŸÑ€å⁄© ÿØ€ïÿ±€ïŸà€ï ÿ®€Ü ÿØÿßÿÆÿ≥ÿ™ŸÜ€å Ÿæ€éÿ¥ŸÜ€åÿßÿ±€ï⁄©ÿßŸÜ
            document.addEventListener('click', (e) => {
                if (!searchSuggestions.contains(e.target) && e.target !== searchInput) {
                    searchSuggestions.classList.remove('active');
                }
                if (!adminSearchSuggestions.contains(e.target) && e.target !== adminSearchInput) {
                    adminSearchSuggestions.classList.remove('active');
                }
                if (!studentSearchSuggestions.contains(e.target) && e.target !== studentSearchInput) {
                    studentSearchSuggestions.classList.remove('active');
                }
                if (!returnSearchSuggestions.contains(e.target) && e.target !== returnSearchInput) {
                    returnSearchSuggestions.classList.remove('active');
                }
                if (!wishlistSidebar.contains(e.target) && e.target !== wishlistToggle && !wishlistToggle.contains(e.target)) {
                    wishlistSidebar.classList.remove('active');
                }
            });
            
            // Close modals
            closeBookModal.addEventListener('click', () => {
                bookDetailsModal.classList.remove('active');
            });
            
            closeBookFormModal.addEventListener('click', () => {
                bookFormModal.classList.remove('active');
                resetBookForm();
            });
            
            cancelRegistrationBtn.addEventListener('click', () => {
                registrationForm.classList.remove('active');
                studentRegistrationForm.reset();
                confirmationMessage.classList.remove('active');
            });
            
            cancelBookFormBtn.addEventListener('click', () => {
                bookFormModal.classList.remove('active');
                resetBookForm();
            });
            
            // ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
            wishlistToggle.addEventListener('click', () => {
                wishlistSidebar.classList.toggle('active');
            });
            
            closeWishlist.addEventListener('click', () => {
                wishlistSidebar.classList.remove('active');
            });
            
            // Student registration form submission
            studentRegistrationForm.addEventListener('submit', handleStudentRegistration);
            
            // Book form submission
            bookForm.addEventListener('submit', handleBookFormSubmit);
            
            // Admin panel navigation
            backToMainBtn.addEventListener('click', () => {
                adminPanel.style.display = 'none';
                document.querySelector('.container').style.display = 'block';
            });
            
            viewBooksBtn.addEventListener('click', () => {
                bookManagementSection.style.display = 'block';
                registeredStudentsSection.style.display = 'none';
                returnBookSection.style.display = 'none';
                displayAdminBooks();
            });
            
            addBookBtn.addEventListener('click', () => {
                showBookForm();
            });
            
            viewRegisteredStudentsBtn.addEventListener('click', async () => {
                bookManagementSection.style.display = 'none';
                registeredStudentsSection.style.display = 'block';
                returnBookSection.style.display = 'none';
                currentStudentView = 'pending';
                updateStudentViewButtons();
                await displayRegisteredStudentsFromFirebase();
            });
            
            returnBookBtn.addEventListener('click', () => {
                bookManagementSection.style.display = 'none';
                registeredStudentsSection.style.display = 'none';
                returnBookSection.style.display = 'block';
                displayReturnBooks();
            });
            
            // Student view toggle buttons
            showPendingBtn.addEventListener('click', async () => {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                showPendingBtn.classList.add('active');
                currentStudentView = 'pending';
                await displayRegisteredStudentsFromFirebase();
            });
            
            showApprovedBtn.addEventListener('click', async () => {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                showApprovedBtn.classList.add('active');
                currentStudentView = 'approved';
                await displayRegisteredStudentsFromFirebase();
            });
            
            showReturnedBtn.addEventListener('click', async () => {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                showReturnedBtn.classList.add('active');
                currentStudentView = 'returned';
                await displayRegisteredStudentsFromFirebase();
            });
            
            // Admin search
            adminSearchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                
                if (searchTerm.trim() !== '') {
                    showSearchSuggestions(searchTerm, adminSearchSuggestions);
                } else {
                    adminSearchSuggestions.classList.remove('active');
                }
                
                displayAdminBooks(searchTerm);
            });
            
            // Student search
            studentSearchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                
                if (searchTerm.trim() !== '') {
                    showStudentSearchSuggestions(searchTerm);
                } else {
                    studentSearchSuggestions.classList.remove('active');
                }
                
                displayRegisteredStudents(searchTerm);
            });
            
            // Return search
            returnSearchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                displayReturnBooks(searchTerm);
            });
        }

        // Load all requests from Firebase ÿØŸàŸÖ
        async function loadAllRequests() {
            try {
                if (!window.firebase2Functions || !window.firebase2Functions.getAllRequests) {
                    throw new Error("Firebase ÿØŸàŸÖ functions not loaded");
                }
                
                allRequests = await window.firebase2Functions.getAllRequests();
                approvedRequests = allRequests.filter(request => request.pasand === true && !request.returned);
                
                console.log(`Loaded ${allRequests.length} total requests, ${approvedRequests.length} approved requests`);
                
                updateStatistics();
                
            } catch (error) {
                console.error('Error loading requests:', error);
                allRequests = [];
                approvedRequests = [];
            }
        }

        // Update statistics
        function updateStatistics() {
            const totalBooks = books.length;
            const wishlistCount = wishlist.length;
            const borrowedBooksCount = approvedRequests.length;
            
            // Update main page statistics
            document.getElementById('totalBooks').textContent = totalBooks;
            document.getElementById('wishlistTotal').textContent = wishlistCount;
            document.getElementById('borrowedBooks').textContent = borrowedBooksCount;
            
            // Update admin statistics
            document.getElementById('adminTotalBooks').textContent = totalBooks;
            const pendingCount = allRequests.filter(r => !r.pasand).length;
            document.getElementById('adminPendingRequests').textContent = pendingCount;
            document.getElementById('adminApprovedRequests').textContent = borrowedBooksCount;
        }

        // Check if a book is currently borrowed
        function isBookBorrowed(bookTitle) {
            return approvedRequests.some(request => 
                request.bookTitle === bookTitle && request.pasand === true && !request.returned
            );
        }

        // Check if a book has pending requests
        function hasPendingRequests(bookTitle) {
            return allRequests.some(request => 
                request.bookTitle === bookTitle && !request.pasand
            );
        }

        // Load books from Firebase
        async function loadBooksFromFirebase() {
            try {
                booksGrid.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>ÿ®ÿßÿ±⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ...</p></div>';
                
                const querySnapshot = await window.firebase.getDocs(
                    window.firebase.collection(window.firebase.db, 'books')
                );
                
                books = [];
                querySnapshot.forEach((doc) => {
                    books.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                console.log(`Loaded ${books.length} books from Firebase`);
                
                if (books.length === 0) {
                    await addSampleBooks();
                }
                
            } catch (error) {
                console.error('Error loading books from Firebase:', error);
                booksGrid.innerHTML = '<div class="empty-state"><i class="fas fa-book"></i><h3>Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© ŸÜ€ïÿØ€Üÿ≤ÿ±ÿß€å€ïŸà€ï</h3><p>€å€ï⁄©€ïŸÖ ⁄©ÿ™€éÿ®€ï⁄©€ïÿ™ ÿ≤€åÿßÿØ ÿ®⁄©€ï</p></div>';
                loadBooksFromLocalStorage();
            }
        }

        // Display books in main page
        function displayBooks() {
            booksGrid.innerHTML = '';
            
            let filteredBooks = books;
            
            if (currentGenre !== 'all') {
                filteredBooks = filteredBooks.filter(book => book.zhanar === currentGenre);
            }
            
            if (currentSearch) {
                filteredBooks = filteredBooks.filter(book => 
                    book.naw.toLowerCase().includes(currentSearch) ||
                    (book.author && book.author.toLowerCase().includes(currentSearch)) ||
                    (book.kurta && book.kurta.toLowerCase().includes(currentSearch)) ||
                    (book.zhanar && book.zhanar.toLowerCase().includes(currentSearch))
                );
            }
            
            if (filteredBooks.length === 0) {
                booksGrid.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><h3>Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© ŸÜ€ïÿØ€Üÿ≤ÿ±ÿß€å€ïŸà€ï</h3><p>⁄Ø€ï⁄ïÿßŸÜ€ï⁄©€ïÿ™ ÿ®⁄Ø€Ü⁄ï€ï €åÿßŸÜ ⁄òÿßŸÜ€ïÿ±€é⁄©€å ÿ™ÿ± Ÿá€ï⁄µÿ®⁄ò€éÿ±€ï</p></div>';
                return;
            }
            
            filteredBooks.forEach(book => {
                const isInWishlist = wishlist.some(item => item.id === book.id);
                const isBorrowed = isBookBorrowed(book.naw);
                const hasPending = hasPendingRequests(book.naw);
                
                const bookCard = document.createElement('div');
                bookCard.className = `book-card`;
                bookCard.innerHTML = `
                    <div class="book-badge">${book.zhanar}</div>
                    ${isBorrowed ? '<div class="book-status-badge">üìñ Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï</div>' : ''}
                    ${hasPending && !isBorrowed ? '<div class="book-status-badge" style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);">‚è≥ ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ</div>' : ''}
                    <button class="add-to-wishlist-btn ${isInWishlist ? 'in-wishlist' : ''}" data-id="${book.id}" data-title="${book.naw}" data-author="${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'}" data-image="${book.linkewena}">
                        <i class="fas fa-heart"></i>
                    </button>
                    <img src="${book.linkewena || 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'}" alt="${book.naw}" class="book-image">
                    <div class="book-info">
                        <div class="book-title">${book.naw}</div>
                        <div class="book-genre"><i class="fas fa-user-edit"></i> ${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'}</div>
                        <div class="book-genre"><i class="fas fa-tag"></i> ${book.zhanar}</div>
                        ${isBorrowed ? '<div style="color: var(--danger-color); font-size: 0.7rem; margin-top: 0.3rem;"><i class="fas fa-info-circle"></i> Ÿæ€éÿ¥ÿ™ÿ± ÿØÿßŸàÿß ⁄©ÿ±ÿß€ï</div>' : ''}
                    </div>
                `;
                
                // Ÿá€ïŸÖŸàŸà ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ ⁄©ŸÑ€å⁄© ÿØ€ï⁄©ÿ±€éŸÜ ÿ®€Ü ÿ®€åŸÜ€åŸÜ€å Ÿàÿ±ÿØ€ï⁄©ÿßÿ±€å
                bookCard.addEventListener('click', (e) => {
                    if (!e.target.closest('.add-to-wishlist-btn')) {
                        showBookDetails(book);
                    }
                });
                
                booksGrid.appendChild(bookCard);
            });
            
            // Add event listeners to wishlist buttons
            document.querySelectorAll('.add-to-wishlist-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const bookId = btn.getAttribute('data-id');
                    const bookTitle = btn.getAttribute('data-title');
                    const bookAuthor = btn.getAttribute('data-author');
                    const bookImage = btn.getAttribute('data-image');
                    
                    toggleWishlist(bookId, bookTitle, bookAuthor, bookImage);
                });
            });
        }

        // Show book details modal
        function showBookDetails(book) {
            const isInWishlist = wishlist.some(item => item.id === book.id);
            const isBorrowed = isBookBorrowed(book.naw);
            const hasPending = hasPendingRequests(book.naw);
            
            const bookDetailsContent = document.getElementById('bookDetailsContent');
            bookDetailsContent.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.2rem;">
                    <h2 style="font-size: 1.3rem; margin: 0;">${book.naw}</h2>
                    <span class="badge" style="background: var(--accent-color); color: var(--dark-color); padding: 0.3rem 0.6rem; font-size: 0.75rem;">${book.zhanar}</span>
                </div>
                
                <img src="${book.linkewena || 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'}" alt="${book.naw}" style="width: 100%; max-height: 250px; object-fit: cover; border-radius: 10px; margin-bottom: 1.2rem;">
                
                <div>
                    <div style="background: var(--light-color); padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                        <h3 style="color: var(--primary-color); margin-bottom: 0.6rem; font-size: 1rem;"><i class="fas fa-info-circle"></i> ÿ≤ÿßŸÜ€åÿßÿ±€å ⁄©ÿ™€éÿ®</h3>
                        <p style="margin-bottom: 0.4rem;"><strong>ŸÜŸàŸàÿ≥€ïÿ±:</strong> ${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'}</p>
                        <p><strong>⁄òÿßŸÜ€ïÿ±:</strong> ${book.zhanar}</p>
                        ${book.createdAt ? `<p style="margin-top: 0.4rem;"><strong>ÿ®€ïÿ±Ÿàÿßÿ±€å ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ:</strong> ${new Date(book.createdAt).toLocaleDateString('ku')}</p>` : ''}
                    </div>
                    
                    ${book.kurta ? `
                    <div style="background: var(--light-color); padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                        <h3 style="color: var(--primary-color); margin-bottom: 0.6rem; font-size: 1rem;"><i class="fas fa-align-left"></i> ⁄©Ÿàÿ±ÿ™€ï</h3>
                        <p style="line-height: 1.5; font-size: 0.9rem;">${book.kurta}</p>
                    </div>
                    ` : ''}
                    
                    ${isBorrowed ? `
                    <div style="background: #FEF3C7; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border-right: 4px solid #D97706;">
                        <h3 style="color: #92400E; margin-bottom: 0.6rem; font-size: 1rem;"><i class="fas fa-exclamation-triangle"></i> ÿ¶ÿß⁄ØÿßÿØÿßÿ±€å</h3>
                        <p style="color: #92400E; font-size: 0.9rem;">Ÿæ€éÿ¥ÿ™ÿ± ÿØÿßŸàÿß ⁄©ÿ±ÿß€ï ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ ÿ®€ï!</p>
                    </div>
                    ` : ''}
                    
                    ${hasPending && !isBorrowed ? `
                    <div style="background: #DBEAFE; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border-right: 4px solid #3B82F6;">
                        <h3 style="color: #1E40AF; margin-bottom: 0.6rem; font-size: 1rem;"><i class="fas fa-info-circle"></i> ÿ≤ÿßŸÜ€åÿßÿ±€å</h3>
                        <p style="color: #1E40AF; font-size: 0.9rem;">ÿ¶€ïŸÖ ⁄©ÿ™€éÿ®€ï ÿØÿßŸàÿß⁄©ÿßÿ±€å ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ€å Ÿá€ï€å€ï.</p>
                    </div>
                    ` : ''}
                    
                    <button class="wishlist-btn ${isInWishlist ? 'in-wishlist' : ''}" id="modalWishlistBtn" data-id="${book.id}" data-title="${book.naw}" data-author="${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'}" data-image="${book.linkewena}" style="background: linear-gradient(135deg, #f56565 0%, #ed8936 100%); color: white; border: none; padding: 0.8rem; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 600; margin-top: 0.5rem; width: 100%; transition: var(--transition); display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                        <i class="fas fa-heart"></i> ${isInWishlist ? 'ŸÑÿßÿ®ÿ±ÿØŸÜ€å ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ' : 'ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ÿ®€Ü ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ'}
                    </button>
                    
                    ${!isBorrowed ? `
                    <button class="borrow-btn" id="borrowBookBtn" data-id="${book.id}" data-title="${book.naw}" style="background: var(--gradient); color: white; border: none; padding: 0.8rem; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 600; margin-top: 0.8rem; width: 100%; transition: var(--transition); display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                        <i class="fas fa-book-reader"></i> ÿØÿßŸàÿß⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®
                    </button>
                    ` : ''}
                </div>
            `;
            
            bookDetailsModal.classList.add('active');
            
            // Add event listener to wishlist button in modal
            document.getElementById('modalWishlistBtn').addEventListener('click', (e) => {
                const bookId = e.target.closest('button').getAttribute('data-id');
                const bookTitle = e.target.closest('button').getAttribute('data-title');
                const bookAuthor = e.target.closest('button').getAttribute('data-author');
                const bookImage = e.target.closest('button').getAttribute('data-image');
                
                toggleWishlist(bookId, bookTitle, bookAuthor, bookImage);
            });
            
            // Add event listener to register button if not borrowed
            if (!isBorrowed) {
                document.getElementById('borrowBookBtn').addEventListener('click', (e) => {
                    const bookId = e.target.getAttribute('data-id');
                    const bookTitle = e.target.getAttribute('data-title');
                    bookDetailsModal.classList.remove('active');
                    showRegistrationForm(bookId, bookTitle);
                });
            }
        }

        // Handle student registration for book borrowing
        async function handleStudentRegistration(e) {
            e.preventDefault();
            
            const studentName = document.getElementById('regStudentName').value;
            const department = document.getElementById('regDepartment').value;
            const stage = document.getElementById('regStage').value;
            const phoneNumber = document.getElementById('regPhoneNumber').value;
            const bookId = document.getElementById('regBookId').value;
            const bookTitle = document.getElementById('regBookTitle').value;
            
            // Check if book is already borrowed
            if (isBookBorrowed(bookTitle)) {
                showNotification('‚ùå Ÿæ€éÿ¥ÿ™ÿ± ÿØÿßŸàÿß ⁄©ÿ±ÿß€ï ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ ÿ®€ï! ÿ™⁄©ÿß€å€ï ⁄©ÿ™€éÿ®€é⁄©€å ÿ™ÿ± Ÿá€ï⁄µÿ®⁄ò€éÿ±€ï.', 'error');
                registrationForm.classList.remove('active');
                return;
            }
            
            // Check if user already has a pending request for this book
            const userPendingRequest = allRequests.find(request => 
                request.name === studentName && 
                request.bookTitle === bookTitle && 
                !request.pasand
            );
            
            if (userPendingRequest) {
                showNotification('‚ùå ÿ™€Ü Ÿæ€éÿ¥ÿ™ÿ± ÿØÿßŸàÿß⁄©ÿßÿ±€åÿ™ ÿ®€Ü ÿ¶€ïŸÖ ⁄©ÿ™€éÿ®€ï ŸÜÿßÿ±ÿØŸàŸà€ï Ÿà ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ€å Ÿæ€ïÿ≥€ïŸÜÿØ⁄©ÿ±ÿØŸÜ€å.', 'warning');
                registrationForm.classList.remove('active');
                return;
            }
            
            const requestForSecondDB = {
                id: `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                name: studentName,
                stage: stage,
                department: department,
                number: phoneNumber,
                dawa: true,
                pasand: false,
                bookTitle: bookTitle,
                bookId: bookId,
                requestDate: new Date().toISOString(),
                returned: false
            };
            
            try {
                if (window.firebase2Functions && window.firebase2Functions.addRequest) {
                    const success = await window.firebase2Functions.addRequest(requestForSecondDB);
                    
                    if (success) {
                        // Add to local state
                        allRequests.push(requestForSecondDB);
                        
                        studentRegistrationForm.reset();
                        confirmationMessage.classList.add('active');
                        
                        showNotification('‚úÖ ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©€ïÿ™ ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ŸÜ€éÿ±ÿØÿ±ÿß!', 'success');
                        
                        setTimeout(() => {
                            registrationForm.classList.remove('active');
                            confirmationMessage.classList.remove('active');
                        }, 3000);
                        
                        // Refresh books display
                        displayBooks();
                        updateStatistics();
                    } else {
                        throw new Error("Failed to save to database");
                    }
                } else {
                    throw new Error("Database functions not available");
                }
                
            } catch (error) {
                console.error('Error saving student request:', error);
                showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ŸÜÿßÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å. ÿ™⁄©ÿß€å€ï ÿØŸàŸàÿ®ÿßÿ±€ï Ÿá€ïŸà⁄µÿ®ÿØ€ïÿ±€ïŸà€ï.', 'error');
            }
        }

        // ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ - ÿ™ŸàŸàÿ¥⁄©ÿ±ÿØŸÜ
        function toggleWishlist(bookId, bookTitle, bookAuthor, bookImage) {
            const existingIndex = wishlist.findIndex(item => item.id === bookId);
            
            if (existingIndex !== -1) {
                // ŸÑÿßÿ®ÿ±ÿØŸÜ€å ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
                wishlist.splice(existingIndex, 1);
                showNotification('üìñ ⁄©ÿ™€éÿ®€ï⁄©€ï ŸÑÿßÿ®ÿ±ÿß ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ', 'warning');
            } else {
                // ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ÿ®€Ü ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
                wishlist.push({
                    id: bookId,
                    title: bookTitle,
                    author: bookAuthor,
                    image: bookImage,
                    addedAt: new Date().toISOString()
                });
                showNotification('‚ù§Ô∏è ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ≤€åÿßÿØ⁄©ÿ±ÿß ÿ®€Ü ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ', 'success');
            }
            
            // Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™⁄©ÿ±ÿØŸÜ€å ŸÑ€åÿ≥ÿ™€ï⁄©€ï
            saveWishlistToLocalStorage();
            
            // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ŸÑ€åÿ≥ÿ™€ï⁄©€ï
            updateWishlistUI();
            updateWishlistCount();
            displayBooks(); // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ÿØŸà⁄ØŸÖ€ï⁄©ÿßŸÜ€å ÿØ⁄µ ŸÑ€ïÿ≥€ïÿ± ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ
            updateModalWishlistButton(bookId); // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ŸÖ€ÜÿØÿßŸÑ
        }

        // Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™⁄©ÿ±ÿØŸÜ€å ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
        function saveWishlistToLocalStorage() {
            localStorage.setItem('libraryWishlist', JSON.stringify(wishlist));
        }

        // ÿ®ÿßÿ±⁄©ÿ±ÿØŸÜ€å ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
        function loadWishlistFromLocalStorage() {
            const savedWishlist = localStorage.getItem('libraryWishlist');
            if (savedWishlist) {
                wishlist = JSON.parse(savedWishlist);
                console.log(`Loaded ${wishlist.length} items from wishlist`);
            } else {
                wishlist = [];
                console.log('No saved wishlist found, starting with empty wishlist');
            }
        }

        // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
        function updateWishlistUI() {
            wishlistContent.innerHTML = '';
            
            if (wishlist.length === 0) {
                emptyWishlist.style.display = 'block';
                return;
            }
            
            emptyWishlist.style.display = 'none';
            
            wishlist.forEach(item => {
                const isBorrowed = isBookBorrowed(item.title);
                
                const wishlistItem = document.createElement('div');
                wishlistItem.className = 'wishlist-item';
                wishlistItem.innerHTML = `
                    <img src="${item.image || 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'}" alt="${item.title}" class="wishlist-item-image">
                    <div class="wishlist-item-info">
                        <div class="wishlist-item-title">${item.title}</div>
                        <div class="wishlist-item-author">${item.author}</div>
                        ${isBorrowed ? '<div style="color: var(--danger-color); font-size: 0.7rem; margin-bottom: 0.3rem;"><i class="fas fa-info-circle"></i> Ÿæ€éÿ¥ÿ™ÿ± ÿØÿßŸàÿß ⁄©ÿ±ÿß€ï</div>' : ''}
                        <div class="wishlist-item-actions">
                            <button class="wishlist-remove-btn" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                            ${!isBorrowed ? `<button class="wishlist-borrow-btn" data-id="${item.id}" data-title="${item.title}">
                                <i class="fas fa-book-reader"></i> ÿØÿßŸàÿß⁄©ÿ±ÿØŸÜ
                            </button>` : ''}
                        </div>
                    </div>
                `;
                
                wishlistContent.appendChild(wishlistItem);
            });
            
            // Event listeners for wishlist items
            document.querySelectorAll('.wishlist-remove-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const bookId = btn.getAttribute('data-id');
                    const bookItem = wishlist.find(item => item.id === bookId);
                    
                    if (bookItem) {
                        wishlist = wishlist.filter(item => item.id !== bookId);
                        saveWishlistToLocalStorage();
                        updateWishlistUI();
                        updateWishlistCount();
                        displayBooks();
                        updateModalWishlistButton(bookId);
                        
                        showNotification('üóëÔ∏è ⁄©ÿ™€éÿ®€ï⁄©€ï ŸÑÿßÿ®ÿ±ÿß ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ', 'warning');
                    }
                });
            });
            
            document.querySelectorAll('.wishlist-borrow-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const bookId = btn.getAttribute('data-id');
                    const bookTitle = btn.getAttribute('data-title');
                    
                    wishlistSidebar.classList.remove('active');
                    showRegistrationForm(bookId, bookTitle);
                });
            });
        }

        // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ÿØŸà⁄ØŸÖ€ï€å ŸÖ€ÜÿØÿßŸÑ€å Ÿàÿ±ÿØ€ï⁄©ÿßÿ±€å ⁄©ÿ™€éÿ®
        function updateModalWishlistButton(bookId) {
            const modalWishlistBtn = document.getElementById('modalWishlistBtn');
            if (modalWishlistBtn && modalWishlistBtn.getAttribute('data-id') === bookId) {
                const isInWishlist = wishlist.some(item => item.id === bookId);
                modalWishlistBtn.innerHTML = `<i class="fas fa-heart"></i> ${isInWishlist ? 'ŸÑÿßÿ®ÿ±ÿØŸÜ€å ŸÑ€ï ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ' : 'ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ÿ®€Ü ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ'}`;
                modalWishlistBtn.classList.toggle('in-wishlist', isInWishlist);
            }
        }

        // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ⁄òŸÖÿßÿ±€ï€å ŸÑ€åÿ≥ÿ™€å ÿØ⁄µÿÆŸàÿßÿ≤€ï⁄©ÿßŸÜ
        function updateWishlistCount() {
            const count = wishlist.length;
            wishlistCount.textContent = count;
            wishlistTotalStat.textContent = count;
            
            // ŸÜŸà€é⁄©ÿ±ÿØŸÜ€å ÿ¶ÿßŸÖÿßÿ±€å ÿ≥€ïÿ±€ï⁄©€å
            updateStatistics();
        }

        // Display registered students from Firebase ÿØŸàŸÖ
        async function displayRegisteredStudentsFromFirebase(searchTerm = '') {
            registeredStudentsTable.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 2rem;"><div class="loading-spinner"></div></td></tr>';
            
            try {
                if (!window.firebase2Functions || !window.firebase2Functions.getAllRequests) {
                    throw new Error("Firebase ÿØŸàŸÖ functions not loaded");
                }
                
                await loadAllRequests(); // Refresh requests
                
                let filteredRequests = allRequests;
                
                if (currentStudentView === 'pending') {
                    filteredRequests = allRequests.filter(request => !request.pasand);
                } else if (currentStudentView === 'approved') {
                    filteredRequests = allRequests.filter(request => request.pasand === true && !request.returned);
                } else if (currentStudentView === 'returned') {
                    filteredRequests = allRequests.filter(request => request.returned === true);
                }
                
                if (searchTerm) {
                    filteredRequests = filteredRequests.filter(request => 
                        (request.name && request.name.toLowerCase().includes(searchTerm)) ||
                        (request.department && request.department.toLowerCase().includes(searchTerm)) ||
                        (request.bookTitle && request.bookTitle.toLowerCase().includes(searchTerm)) ||
                        (request.stage && request.stage.toLowerCase().includes(searchTerm)) ||
                        (request.number && request.number.includes(searchTerm))
                    );
                }
                
                displayRegisteredStudentsTable(filteredRequests);
                
            } catch (error) {
                console.error('Error loading students from Firebase ÿØŸàŸÖ:', error);
                registeredStudentsTable.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 2rem;">
                            <div class="empty-state">
                                <i class="fas fa-exclamation-triangle"></i>
                                <h3>Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß</h3>
                                <p>ŸÜÿßÿ™ŸàÿßŸÜÿ±€éÿ™ ÿ≤ÿßŸÜ€åÿßÿ±€å€ï⁄©ÿßŸÜ ÿ®ÿßÿ±ÿ®⁄©ÿ±€éŸÜ</p>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }

        // Display registered students table
        function displayRegisteredStudentsTable(requests) {
            registeredStudentsTable.innerHTML = '';
            
            if (requests.length === 0) {
                const noDataText = currentStudentView === 'pending' 
                    ? 'Ÿá€å⁄Ü ÿØÿßŸàÿß⁄©ÿßÿ±€å€å€ï⁄©€å ⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ ŸÜ€ï⁄©ÿ±ÿßŸà€ï' 
                    : currentStudentView === 'approved'
                    ? 'Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà ŸÜ€å€ï'
                    : 'Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© ⁄Ø€ï⁄ï€éŸÜÿØÿ±ÿßŸà€ïÿ™€ïŸà€ï ŸÜ€å€ï';
                
                registeredStudentsTable.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 2rem;">
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <h3>${noDataText}</h3>
                                <p>⁄©ÿßÿ™€é⁄© ÿØÿßŸàÿß⁄©ÿßÿ±€å ŸÜŸà€é Ÿáÿßÿ™ÿå ŸÑ€éÿ±€ï ÿØ€ïÿ±ÿØ€ï⁄©€ïŸàŸÜ</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            requests.forEach(request => {
                const statusText = request.returned ? '⁄Ø€ï⁄ï€éŸÜÿØÿ±ÿßŸà€ïÿ™€ïŸà€ï' : 
                                 request.pasand ? 'Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï' : '⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ';
                const statusClass = request.returned ? 'status-rejected' : 
                                  request.pasand ? 'status-approved' : 'status-pending';
                const date = request.requestDate ? new Date(request.requestDate).toLocaleDateString('ku') : 
                           (request.createdAt ? new Date(request.createdAt).toLocaleDateString('ku') : 'ŸÜ€ïÿ≤ÿßŸÜÿ±ÿßŸà');
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${request.name || '---'}</strong></td>
                    <td>${request.department || '---'}</td>
                    <td><span class="badge">${request.stage || '---'}</span></td>
                    <td>${request.number || request.phoneNumber || '---'}</td>
                    <td><em>${request.bookTitle || 'Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄©'}</em></td>
                    <td>${date}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        ${!request.pasand ? 
                            `<button class="action-btn approve-btn" data-id="${request.id}"><i class="fas fa-check"></i> Ÿæ€ïÿ≥€ïŸÜÿØ⁄©ÿ±ÿØŸÜ</button>
                             <button class="action-btn reject-btn" data-id="${request.id}"><i class="fas fa-times"></i> ⁄ï€ïÿ™⁄©ÿ±ÿØŸÜ€ïŸà€ï</button>` 
                            : request.pasand && !request.returned ?
                            `<button class="action-btn reject-btn" data-id="${request.id}" data-action="return"><i class="fas fa-undo-alt"></i> ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï</button>`
                            : ''}
                        <button class="action-btn delete-btn" data-id="${request.id}"><i class="fas fa-trash"></i> ÿ≥⁄ï€åŸÜ€ïŸà€ï</button>
                    </td>
                `;
                
                registeredStudentsTable.appendChild(row);
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('.approve-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const requestId = e.target.closest('button').getAttribute('data-id');
                    await approveStudentRequest(requestId);
                });
            });
            
            document.querySelectorAll('.reject-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const requestId = e.target.closest('button').getAttribute('data-id');
                    const action = btn.getAttribute('data-action');
                    
                    if (action === 'return') {
                        await returnBook(requestId);
                    } else {
                        await rejectStudentRequest(requestId);
                    }
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const requestId = e.target.closest('button').getAttribute('data-id');
                    await deleteStudentRequest(requestId);
                });
            });
        }

        // Display return books table
        function displayReturnBooks(searchTerm = '') {
            returnBooksTable.innerHTML = '';
            
            let filteredRequests = allRequests.filter(request => 
                request.pasand === true && !request.returned
            );
            
            if (searchTerm) {
                filteredRequests = filteredRequests.filter(request => 
                    (request.name && request.name.toLowerCase().includes(searchTerm)) ||
                    (request.department && request.department.toLowerCase().includes(searchTerm)) ||
                    (request.bookTitle && request.bookTitle.toLowerCase().includes(searchTerm)) ||
                    (request.number && request.number.includes(searchTerm))
                );
            }
            
            if (filteredRequests.length === 0) {
                returnBooksTable.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem;">
                            <div class="empty-state">
                                <i class="fas fa-book"></i>
                                <h3>Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà ŸÜ€å€ï</h3>
                                <p>Ÿá€ïŸÖŸàŸà ⁄©ÿ™€éÿ®€ï⁄©ÿßŸÜ ÿ®€ïÿ±ÿØ€ïÿ≥ÿ™ŸÜ</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            filteredRequests.forEach(request => {
                const requestDate = request.requestDate ? new Date(request.requestDate) : 
                                  request.createdAt ? new Date(request.createdAt) : new Date();
                const daysPassed = Math.floor((new Date() - requestDate) / (1000 * 60 * 60 * 24));
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${request.name || '---'}</strong></td>
                    <td>${request.department || '---'}</td>
                    <td>${request.number || request.phoneNumber || '---'}</td>
                    <td><em>${request.bookTitle || 'Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄©'}</em></td>
                    <td>${requestDate.toLocaleDateString('ku')}</td>
                    <td><span class="badge ${daysPassed > 14 ? 'badge-featured' : 'badge-popular'}">${daysPassed} ⁄ï€Ü⁄ò</span></td>
                    <td>
                        <button class="action-btn approve-btn" data-id="${request.id}" data-action="return"><i class="fas fa-undo-alt"></i> ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï</button>
                        <button class="action-btn delete-btn" data-id="${request.id}"><i class="fas fa-trash"></i> ÿ≥⁄ï€åŸÜ€ïŸà€ï</button>
                    </td>
                `;
                
                returnBooksTable.appendChild(row);
            });
            
            // Add event listeners to return buttons
            document.querySelectorAll('.approve-btn[data-action="return"]').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const requestId = e.target.closest('button').getAttribute('data-id');
                    await returnBook(requestId);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const requestId = e.target.closest('button').getAttribute('data-id');
                    await deleteStudentRequest(requestId);
                });
            });
        }

        // Approve student request
        async function approveStudentRequest(requestId) {
            if (confirm('ÿ¶ÿß€åÿß ÿØ⁄µŸÜ€åÿß€å ⁄©€ï ÿØ€ïÿ™€ïŸà€éÿ™ ÿ¶€ïŸÖ ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï Ÿæ€ïÿ≥€ïŸÜÿØ ÿ®⁄©€ï€åÿ™ÿü')) {
                try {
                    if (window.firebase2Functions && window.firebase2Functions.approveRequest) {
                        const success = await window.firebase2Functions.approveRequest(requestId);
                        
                        if (success) {
                            // Update local state
                            const requestIndex = allRequests.findIndex(r => r.id === requestId);
                            if (requestIndex !== -1) {
                                allRequests[requestIndex].pasand = true;
                                allRequests[requestIndex].approvedDate = new Date().toISOString();
                            }
                            
                            approvedRequests = allRequests.filter(request => request.pasand === true && !request.returned);
                            
                            await displayRegisteredStudentsFromFirebase();
                            displayBooks(); // Update book status on main page
                            updateStatistics();
                            showNotification('‚úÖ ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©€ï Ÿæ€ïÿ≥€ïŸÜÿØ⁄©ÿ±ÿß Ÿà ⁄©ÿ™€éÿ®€ï⁄©€ï Ÿà€ïÿ±⁄Ø€åÿ±ÿß', 'success');
                        } else {
                            throw new Error("Failed to approve request");
                        }
                    } else {
                        throw new Error("Database functions not available");
                    }
                    
                } catch (error) {
                    console.error('Error approving request:', error);
                    showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï Ÿæ€ïÿ≥€ïŸÜÿØ⁄©ÿ±ÿØŸÜ€å ÿØÿßŸàÿß⁄©ÿßÿ±€å', 'error');
                }
            }
        }

        // Return book
        async function returnBook(requestId) {
            if (confirm('ÿ¶ÿß€åÿß ÿØ⁄µŸÜ€åÿß€å ⁄©€ï ÿ¶€ïŸÖ ⁄©ÿ™€éÿ®€ï ⁄Ø€ï⁄ï€éŸÜÿØÿ±ÿßŸà€ïÿ™€ïŸà€ïÿü')) {
                try {
                    const request = allRequests.find(r => r.id === requestId);
                    if (!request) {
                        throw new Error("Request not found");
                    }
                    
                    // Update in Firebase ÿØŸàŸÖ
                    const entryRef = window.firebase2.doc(window.firebase2.db, "Language", requestId);
                    await window.firebase2.updateDoc(entryRef, { 
                        returned: true,
                        returnDate: new Date().toISOString()
                    });
                    
                    // Update local state
                    const requestIndex = allRequests.findIndex(r => r.id === requestId);
                    if (requestIndex !== -1) {
                        allRequests[requestIndex].returned = true;
                        allRequests[requestIndex].returnDate = new Date().toISOString();
                    }
                    
                    approvedRequests = allRequests.filter(request => request.pasand === true && !request.returned);
                    
                    // Refresh displays
                    await displayRegisteredStudentsFromFirebase();
                    displayReturnBooks();
                    displayBooks(); // Update book status on main page
                    updateStatistics();
                    showNotification('‚úÖ ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ⁄Ø€ï⁄ï€éŸÜÿØÿ±ÿß€å€ïŸà€ï', 'success');
                    
                } catch (error) {
                    console.error('Error returning book:', error);
                    showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ⁄Ø€ï⁄ïÿßŸÜÿØŸÜ€ïŸà€ï€å ⁄©ÿ™€éÿ®', 'error');
                }
            }
        }

        // Delete student request (ÿ≥⁄ï€åŸÜ€ïŸà€ï€å ÿØÿßŸàÿß⁄©ÿßÿ±€å)
        async function deleteStudentRequest(requestId) {
            if (confirm('ÿ¶ÿß€åÿß ÿØ⁄µŸÜ€åÿß€å ⁄©€ï ÿØ€ïÿ™€ïŸà€éÿ™ ÿ¶€ïŸÖ ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï ÿ®ÿ≥⁄ï€åÿ™€ïŸà€ïÿü')) {
                try {
                    const request = allRequests.find(r => r.id === requestId);
                    if (!request) {
                        throw new Error("Request not found");
                    }
                    
                    // Delete from Firebase ÿØŸàŸÖ
                    if (window.firebase2Functions && window.firebase2Functions.rejectRequest) {
                        await window.firebase2Functions.rejectRequest(requestId);
                    }
                    
                    // Remove from local state
                    allRequests = allRequests.filter(r => r.id !== requestId);
                    
                    // If it was an approved request, update approvedRequests
                    if (request.pasand && !request.returned) {
                        approvedRequests = allRequests.filter(r => r.pasand === true && !r.returned);
                    }
                    
                    // Refresh displays
                    await displayRegisteredStudentsFromFirebase();
                    displayReturnBooks();
                    displayBooks(); // Update book status on main page
                    updateStatistics();
                    showNotification('üóëÔ∏è ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©€ï ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ÿ≥⁄ïÿØÿ±ÿß€å€ïŸà€ï', 'success');
                    
                } catch (error) {
                    console.error('Error deleting request:', error);
                    showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ÿ≥⁄ï€åŸÜ€ïŸà€ï€å ÿØÿßŸàÿß⁄©ÿßÿ±€å', 'error');
                }
            }
        }

        // Reject student request
        async function rejectStudentRequest(requestId) {
            if (confirm('ÿ¶ÿß€åÿß ÿØ⁄µŸÜ€åÿß€å ⁄©€ï ÿØ€ïÿ™€ïŸà€éÿ™ ÿ¶€ïŸÖ ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï ⁄ï€ïÿ™ ÿ®⁄©€ï€åÿ™€ïŸà€ïÿü')) {
                try {
                    const request = allRequests.find(r => r.id === requestId);
                    if (!request) {
                        throw new Error("Request not found");
                    }
                    
                    // Delete from Firebase ÿØŸàŸÖ
                    if (window.firebase2Functions && window.firebase2Functions.rejectRequest) {
                        await window.firebase2Functions.rejectRequest(requestId);
                    }
                    
                    // Remove from local state
                    allRequests = allRequests.filter(r => r.id !== requestId);
                    
                    // Refresh displays
                    await displayRegisteredStudentsFromFirebase();
                    displayBooks(); // Update book status on main page
                    updateStatistics();
                    showNotification('‚ùå ÿØÿßŸàÿß⁄©ÿßÿ±€å€ï⁄©€ï ⁄ï€ïÿ™⁄©ÿ±ÿß€å€ïŸà€ï', 'success');
                    
                } catch (error) {
                    console.error('Error rejecting request:', error);
                    showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ⁄ï€ïÿ™⁄©ÿ±ÿØŸÜ€ïŸà€ï€å ÿØÿßŸàÿß⁄©ÿßÿ±€å', 'error');
                }
            }
        }

        // Show registration form
        function showRegistrationForm(bookId, bookTitle) {
            document.getElementById('regBookId').value = bookId;
            document.getElementById('regBookTitle').value = bookTitle;
            registrationForm.classList.add('active');
            confirmationMessage.classList.remove('active');
            studentRegistrationForm.reset();
            
            // Scroll to registration form
            registrationForm.scrollIntoView({ behavior: 'smooth' });
        }

        // Handle admin login
        function handleAdminLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                currentUser = { username, role: 'admin' };
                adminLoginModal.classList.remove('active');
                adminLoginForm.reset();
                loginError.style.display = 'none';
                
                // Show admin panel
                document.querySelector('.container').style.display = 'none';
                adminPanel.style.display = 'block';
                
                // Load admin data
                displayAdminBooks();
                displayRegisteredStudentsFromFirebase();
                
                showNotification('‚úÖ ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ⁄ÜŸàŸàÿ™€ï ⁄òŸàŸàÿ±€ïŸà€ï Ÿà€ï⁄© ÿ¶€ïÿØŸÖ€åŸÜ', 'success');
            } else {
                loginError.style.display = 'block';
            }
        }

        // Display admin books
        function displayAdminBooks(searchTerm = '') {
            adminBooksTable.innerHTML = '';
            
            let filteredBooks = books;
            
            if (searchTerm) {
                filteredBooks = filteredBooks.filter(book => 
                    book.naw.toLowerCase().includes(searchTerm) ||
                    (book.author && book.author.toLowerCase().includes(searchTerm)) ||
                    (book.zhanar && book.zhanar.toLowerCase().includes(searchTerm))
                );
            }
            
            if (filteredBooks.length === 0) {
                adminBooksTable.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 2rem;">
                            <div class="empty-state">
                                <i class="fas fa-book"></i>
                                <h3>Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© ŸÜ€ïÿØ€Üÿ≤ÿ±ÿß€å€ïŸà€ï</h3>
                                <p>⁄©ÿ™€éÿ®€é⁄©€å ŸÜŸà€é ÿ≤€åÿßÿØ ÿ®⁄©€ï</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            filteredBooks.forEach(book => {
                const isBorrowed = isBookBorrowed(book.naw);
                const hasPending = hasPendingRequests(book.naw);
                
                let statusText = 'ÿ®€ïÿ±ÿØ€ïÿ≥ÿ™€ï';
                let statusClass = 'status-approved';
                
                if (isBorrowed) {
                    statusText = 'Ÿà€ïÿ±⁄Ø€åÿ±ÿßŸà€ï';
                    statusClass = 'status-pending';
                } else if (hasPending) {
                    statusText = '⁄ÜÿßŸà€ï⁄ïŸàÿßŸÜ';
                    statusClass = 'status-pending';
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><img src="${book.linkewena || 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=100&q=80'}" alt="${book.naw}" style="width: 45px; height: 60px; object-fit: cover; border-radius: 5px;"></td>
                    <td><strong>${book.naw}</strong></td>
                    <td>${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'}</td>
                    <td><span class="badge">${book.zhanar}</span></td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn edit-btn" data-id="${book.id}"><i class="fas fa-edit"></i> ÿØ€ïÿ≥ÿ™⁄©ÿßÿ±€å</button>
                        <button class="action-btn delete-btn" data-id="${book.id}"><i class="fas fa-trash"></i> ÿ≥⁄ï€åŸÜ€ïŸà€ï</button>
                    </td>
                `;
                
                adminBooksTable.appendChild(row);
            });
            
            // Add event listeners to edit buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const bookId = e.target.closest('button').getAttribute('data-id');
                    editBook(bookId);
                });
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const bookId = e.target.closest('button').getAttribute('data-id');
                    deleteBook(bookId);
                });
            });
        }

        // Show book form for adding/editing
        function showBookForm(book = null) {
            editingBookId = book ? book.id : null;
            
            if (book) {
                bookFormTitle.textContent = 'üìù ÿØ€ïÿ≥ÿ™⁄©ÿßÿ±€å⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®';
                document.getElementById('bookId').value = book.id;
                document.getElementById('bookTitle').value = book.naw;
                document.getElementById('bookAuthor').value = book.author || '';
                document.getElementById('bookGenre').value = book.zhanar || '';
                document.getElementById('bookSummary').value = book.kurta || '';
                document.getElementById('bookImage').value = book.linkewena || '';
                bookFormSubmitBtn.innerHTML = '<i class="fas fa-save"></i> ŸÜŸà€é⁄©ÿ±ÿØŸÜ€ïŸà€ï';
            } else {
                bookFormTitle.textContent = 'üìñ ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®€å ŸÜŸà€é';
                resetBookForm();
                bookFormSubmitBtn.innerHTML = '<i class="fas fa-save"></i> Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™';
            }
            
            bookFormModal.classList.add('active');
        }

        // Reset book form
        function resetBookForm() {
            bookForm.reset();
            document.getElementById('bookId').value = '';
            editingBookId = null;
        }

        // Handle book form submission
        async function handleBookFormSubmit(e) {
            e.preventDefault();
            
            const bookData = {
                naw: document.getElementById('bookTitle').value,
                author: document.getElementById('bookAuthor').value,
                zhanar: document.getElementById('bookGenre').value,
                kurta: document.getElementById('bookSummary').value,
                linkewena: document.getElementById('bookImage').value,
                createdAt: new Date().toISOString()
            };
            
            try {
                if (editingBookId) {
                    // Update existing book
                    const bookRef = window.firebase.doc(window.firebase.db, 'books', editingBookId);
                    await window.firebase.updateDoc(bookRef, bookData);
                    
                    // Update local state
                    const bookIndex = books.findIndex(b => b.id === editingBookId);
                    if (bookIndex !== -1) {
                        books[bookIndex] = { ...books[bookIndex], ...bookData };
                    }
                    
                    showNotification('‚úÖ ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ŸÜŸà€é⁄©ÿ±ÿß€å€ïŸà€ï', 'success');
                } else {
                    // Add new book
                    const docRef = await window.firebase.addDoc(
                        window.firebase.collection(window.firebase.db, 'books'),
                        bookData
                    );
                    
                    // Add to local state
                    books.push({
                        id: docRef.id,
                        ...bookData
                    });
                    
                    showNotification('‚úÖ ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ÿ≤€åÿßÿØ⁄©ÿ±ÿß', 'success');
                }
                
                // Close modal and refresh
                bookFormModal.classList.remove('active');
                resetBookForm();
                displayBooks();
                displayAdminBooks();
                updateStatistics();
                
            } catch (error) {
                console.error('Error saving book:', error);
                showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™⁄©ÿ±ÿØŸÜ€å ⁄©ÿ™€éÿ®', 'error');
            }
        }

        // Edit book
        function editBook(bookId) {
            const book = books.find(b => b.id === bookId);
            if (book) {
                showBookForm(book);
            }
        }

        // Delete book
        async function deleteBook(bookId) {
            if (confirm('ÿ¶ÿß€åÿß ÿØ⁄µŸÜ€åÿß€å ⁄©€ï ÿØ€ïÿ™€ïŸà€éÿ™ ÿ¶€ïŸÖ ⁄©ÿ™€éÿ®€ï ÿ®ÿ≥⁄ï€åÿ™€ïŸà€ïÿü')) {
                try {
                    // Check if book has any pending or approved requests
                    const bookTitle = books.find(b => b.id === bookId)?.naw;
                    const hasRequests = allRequests.some(r => r.bookTitle === bookTitle);
                    
                    if (hasRequests) {
                        if (!confirm('ÿ¶€ïŸÖ ⁄©ÿ™€éÿ®€ï ÿØÿßŸàÿß⁄©ÿßÿ±€å Ÿá€ï€å€ï. ÿ¶ÿß€åÿß Ÿá€éÿ¥ÿ™ÿß ÿØ€ïÿ™€ïŸà€éÿ™ ÿ®ÿ≥⁄ï€åÿ™€ïŸà€ïÿü')) {
                            return;
                        }
                    }
                    
                    // Delete from Firebase
                    const bookRef = window.firebase.doc(window.firebase.db, 'books', bookId);
                    await window.firebase.deleteDoc(bookRef);
                    
                    // Remove from local state
                    books = books.filter(b => b.id !== bookId);
                    
                    // Remove from wishlist
                    wishlist = wishlist.filter(item => item.id !== bookId);
                    saveWishlistToLocalStorage();
                    updateWishlistCount();
                    updateWishlistUI();
                    
                    // Refresh displays
                    displayBooks();
                    displayAdminBooks();
                    updateStatistics();
                    
                    showNotification('üóëÔ∏è ⁄©ÿ™€éÿ®€ï⁄©€ï ÿ®€ï ÿ≥€ïÿ±⁄©€ïŸàÿ™ŸàŸà€å€å ÿ≥⁄ïÿØÿ±ÿß€å€ïŸà€ï', 'success');
                    
                } catch (error) {
                    console.error('Error deleting book:', error);
                    showNotification('‚ùå Ÿá€ï⁄µ€ï ⁄ïŸàŸà€åÿØÿß ŸÑ€ï ÿ≥⁄ï€åŸÜ€ïŸà€ï€å ⁄©ÿ™€éÿ®', 'error');
                }
            }
        }

        // Show search suggestions
        function showSearchSuggestions(searchTerm, suggestionsContainer) {
            const filteredBooks = books.filter(book => 
                book.naw.toLowerCase().includes(searchTerm) ||
                (book.author && book.author.toLowerCase().includes(searchTerm)) ||
                (book.zhanar && book.zhanar.toLowerCase().includes(searchTerm))
            );
            
            suggestionsContainer.innerHTML = '';
            
            if (filteredBooks.length === 0) {
                suggestionsContainer.innerHTML = '<div class="suggestion-item">Ÿá€å⁄Ü ⁄©ÿ™€éÿ®€é⁄© ŸÜ€ïÿØ€Üÿ≤ÿ±ÿß€å€ïŸà€ï</div>';
            } else {
                filteredBooks.slice(0, 5).forEach(book => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'suggestion-item';
                    suggestion.innerHTML = `
                        <strong>${book.naw}</strong><br>
                        <small>${book.author || 'ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà'} - ${book.zhanar}</small>
                    `;
                    suggestion.addEventListener('click', () => {
                        searchInput.value = book.naw;
                        currentSearch = book.naw.toLowerCase();
                        suggestionsContainer.classList.remove('active');
                        displayBooks();
                        showBookDetails(book);
                    });
                    suggestionsContainer.appendChild(suggestion);
                });
            }
            
            suggestionsContainer.classList.add('active');
        }

        // Show student search suggestions
        function showStudentSearchSuggestions(searchTerm) {
            const filteredRequests = allRequests.filter(request => 
                (request.name && request.name.toLowerCase().includes(searchTerm)) ||
                (request.department && request.department.toLowerCase().includes(searchTerm)) ||
                (request.bookTitle && request.bookTitle.toLowerCase().includes(searchTerm))
            );
            
            studentSearchSuggestions.innerHTML = '';
            
            if (filteredRequests.length === 0) {
                studentSearchSuggestions.innerHTML = '<div class="suggestion-item">Ÿá€å⁄Ü ÿÆŸà€éŸÜÿØ⁄©ÿßÿ±€é⁄© ŸÜ€ïÿØ€Üÿ≤ÿ±ÿß€å€ïŸà€ï</div>';
            } else {
                filteredRequests.slice(0, 5).forEach(request => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'suggestion-item';
                    suggestion.innerHTML = `
                        <strong>${request.name}</strong><br>
                        <small>${request.department} - ${request.bookTitle}</small>
                    `;
                    suggestion.addEventListener('click', () => {
                        studentSearchInput.value = request.name;
                        studentSearchSuggestions.classList.remove('active');
                        displayRegisteredStudents(request.name.toLowerCase());
                    });
                    studentSearchSuggestions.appendChild(suggestion);
                });
            }
            
            studentSearchSuggestions.classList.add('active');
        }

        // Display registered students with search
        function displayRegisteredStudents(searchTerm = '') {
            let filteredRequests = allRequests;
            
            if (currentStudentView === 'pending') {
                filteredRequests = allRequests.filter(request => !request.pasand);
            } else if (currentStudentView === 'approved') {
                filteredRequests = allRequests.filter(request => request.pasand === true && !request.returned);
            } else if (currentStudentView === 'returned') {
                filteredRequests = allRequests.filter(request => request.returned === true);
            }
            
            if (searchTerm) {
                filteredRequests = filteredRequests.filter(request => 
                    (request.name && request.name.toLowerCase().includes(searchTerm)) ||
                    (request.department && request.department.toLowerCase().includes(searchTerm)) ||
                    (request.bookTitle && request.bookTitle.toLowerCase().includes(searchTerm))
                );
            }
            
            displayRegisteredStudentsTable(filteredRequests);
        }

        // Update student view buttons
        function updateStudentViewButtons() {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            if (currentStudentView === 'pending') {
                showPendingBtn.classList.add('active');
            } else if (currentStudentView === 'approved') {
                showApprovedBtn.classList.add('active');
            } else if (currentStudentView === 'returned') {
                showReturnedBtn.classList.add('active');
            }
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}-notification`;
            
            let icon = 'fas fa-check-circle';
            if (type === 'error') icon = 'fas fa-exclamation-circle';
            if (type === 'warning') icon = 'fas fa-exclamation-triangle';
            
            notification.innerHTML = `
                <i class="${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1) reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Load books from local storage (fallback)
        function loadBooksFromLocalStorage() {
            const savedBooks = localStorage.getItem('libraryBooks');
            if (savedBooks) {
                books = JSON.parse(savedBooks);
                console.log(`Loaded ${books.length} books from local storage`);
            } else {
                books = [];
                console.log('No saved books found, starting with empty library');
            }
        }

        // Add sample books
        async function addSampleBooks() {
            const sampleBooks = [
                {
                    naw: 'ŸÖ€é⁄òŸàŸà€å ⁄©Ÿàÿ±ÿØ',
                    author: 'ÿØ. ⁄©€ïŸÖÿßŸÑ ŸÖ€ïÿ≤⁄æ€ïÿ±',
                    zhanar: 'ŸÖ€é⁄òŸàŸà',
                    kurta: '⁄©ÿ™€éÿ®€é⁄©€å ÿØ€ïŸÇ€å ÿ≤ÿßŸÜÿ≥ÿ™€å€ï ⁄©€ï ŸÖ€é⁄òŸàŸà€å ⁄©Ÿàÿ±ÿØ Ÿà ⁄©Ÿàÿ±ÿØÿ≥ÿ™ÿßŸÜ ÿ®ÿßÿ≥ ÿØ€ï⁄©ÿßÿ™',
                    linkewena: 'https://images.unsplash.com/photo-1541963463532-d68292c34b19?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'
                },
                {
                    naw: '⁄ï€ÜŸÖÿßŸÜ€å ÿ¥€ïŸàÿßŸÜ€å ÿ®€ïÿ∫ÿØÿß',
                    author: 'ŸÜŸàŸàÿ≥€ïÿ± ŸÜ€ïŸÜÿßÿ≥ÿ±ÿßŸà',
                    zhanar: '⁄ï€ÜŸÖÿßŸÜ',
                    kurta: '⁄ï€ÜŸÖÿßŸÜ€é⁄©€å ÿ≥€ïÿ±ÿØ€ïŸÖ€å ŸÖ€ÜÿØ€éÿ±ŸÜ ⁄©€ï ⁄Ü€åÿ±€Ü⁄©€ï⁄©€ï€å ŸÑ€ï ÿ¥ÿßÿ±€å ÿ®€ïÿ∫ÿØÿßÿØ€ï',
                    linkewena: 'https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'
                },
                {
                    naw: 'ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ€å ÿ¶€åŸÜ⁄ØŸÑ€åÿ≤€å',
                    author: 'ÿØ. ÿ≥€ïŸÑÿßŸÖ ŸÜÿßŸàÿÆ€Üÿ¥',
                    zhanar: 'ŸÅ€éÿ±⁄©ÿßÿ±€å ÿ≤ŸÖÿßŸÜ',
                    kurta: '⁄©ÿ™€éÿ®€é⁄© ÿ®€Ü ŸÅ€éÿ±ÿ®ŸàŸàŸÜ€å ÿ≤ŸÖÿßŸÜ€å ÿ¶€åŸÜ⁄ØŸÑ€åÿ≤€å ÿ®€ï ÿ¥€éŸà€ï€å€ï⁄©€å ÿ≥ÿßÿØ€ï',
                    linkewena: 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'
                }
            ];
            
            try {
                for (const book of sampleBooks) {
                    const docRef = await window.firebase.addDoc(
                        window.firebase.collection(window.firebase.db, 'books'),
                        {
                            ...book,
                            createdAt: new Date().toISOString()
                        }
                    );
                    books.push({
                        id: docRef.id,
                        ...book,
                        createdAt: new Date().toISOString()
                    });
                }
                console.log('Sample books added to Firebase');
            } catch (error) {
                console.error('Error adding sample books:', error);
                // Save to local storage as fallback
                books = sampleBooks.map((book, index) => ({
                    id: `book_${index}`,
                    ...book,
                    createdAt: new Date().toISOString()
                }));
                localStorage.setItem('libraryBooks', JSON.stringify(books));
            }
        }
    </script>
</body>
</html>
